[
  {
    "name": "capitalize",
    "language": "javascript",
    "patternType": "utility",
    "description": "Capitalize first letter of string",
    "tags": [
      "string",
      "utility"
    ],
    "code": "function capitalize(s) {\n  return s ? s[0].toUpperCase() + s.slice(1) : '';\n}",
    "testCode": "if (capitalize('hello') !== 'Hello') throw new Error('basic');\nif (capitalize('') !== '') throw new Error('empty');\nif (capitalize('A') !== 'A') throw new Error('already');"
  },
  {
    "name": "camel-case",
    "language": "javascript",
    "patternType": "utility",
    "description": "Convert string to camelCase",
    "tags": [
      "string",
      "utility",
      "case"
    ],
    "code": "function camelCase(str) {\n  return str.replace(/[-_\\s]+(.)?/g, (_, c) => c ? c.toUpperCase() : '')\n            .replace(/^[A-Z]/, c => c.toLowerCase());\n}",
    "testCode": "if (camelCase('hello-world') !== 'helloWorld') throw new Error('kebab');\nif (camelCase('foo_bar') !== 'fooBar') throw new Error('snake');\nif (camelCase('Hello World') !== 'helloWorld') throw new Error('space');"
  },
  {
    "name": "snake-case",
    "language": "javascript",
    "patternType": "utility",
    "description": "Convert string to snake_case",
    "tags": [
      "string",
      "utility",
      "case"
    ],
    "code": "function snakeCase(str) {\n  return str.replace(/([a-z])([A-Z])/g, '$1_$2')\n            .replace(/[-\\s]+/g, '_').toLowerCase();\n}",
    "testCode": "if (snakeCase('helloWorld') !== 'hello_world') throw new Error('camel');\nif (snakeCase('hello-world') !== 'hello_world') throw new Error('kebab');\nif (snakeCase('Hello World') !== 'hello_world') throw new Error('space');"
  },
  {
    "name": "kebab-case",
    "language": "javascript",
    "patternType": "utility",
    "description": "Convert string to kebab-case",
    "tags": [
      "string",
      "utility",
      "case"
    ],
    "code": "function kebabCase(str) {\n  return str.replace(/([a-z])([A-Z])/g, '$1-$2')\n            .replace(/[_\\s]+/g, '-').toLowerCase();\n}",
    "testCode": "if (kebabCase('helloWorld') !== 'hello-world') throw new Error('camel');\nif (kebabCase('hello_world') !== 'hello-world') throw new Error('snake');\nif (kebabCase('Hello World') !== 'hello-world') throw new Error('space');"
  },
  {
    "name": "truncate",
    "language": "javascript",
    "patternType": "utility",
    "description": "Truncate string to max length with suffix",
    "tags": [
      "string",
      "utility"
    ],
    "code": "function truncate(str, maxLen, suffix) {\n  suffix = suffix || '...';\n  if (str.length <= maxLen) return str;\n  return str.slice(0, maxLen - suffix.length) + suffix;\n}",
    "testCode": "if (truncate('hello world', 8) !== 'hello...') throw new Error('basic');\nif (truncate('hi', 10) !== 'hi') throw new Error('short');\nif (truncate('abcdef', 5, '..') !== 'abc..') throw new Error('custom');"
  },
  {
    "name": "slugify",
    "language": "javascript",
    "patternType": "utility",
    "description": "Convert string to URL-friendly slug",
    "tags": [
      "string",
      "utility",
      "url"
    ],
    "code": "function slugify(str) {\n  return str.toLowerCase().trim()\n    .replace(/[^a-z0-9\\s-]/g, '')\n    .replace(/[\\s-]+/g, '-')\n    .replace(/^-+|-+$/g, '');\n}",
    "testCode": "if (slugify('Hello World!') !== 'hello-world') throw new Error('basic');\nif (slugify('  foo  bar  ') !== 'foo-bar') throw new Error('spaces');\nif (slugify('a--b') !== 'a-b') throw new Error('dashes');"
  },
  {
    "name": "escape-html",
    "language": "javascript",
    "patternType": "utility",
    "description": "Escape HTML special characters",
    "tags": [
      "string",
      "security",
      "html"
    ],
    "code": "function escapeHTML(str) {\n  var map = {'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',\"'\":'&#39;'};\n  return str.replace(/[&<>\"']/g, function(c) { return map[c]; });\n}",
    "testCode": "if (escapeHTML('<b>hi</b>') !== '&lt;b&gt;hi&lt;/b&gt;') throw new Error('tags');\nif (escapeHTML('a&b') !== 'a&amp;b') throw new Error('amp');\nif (escapeHTML('hello') !== 'hello') throw new Error('noop');"
  },
  {
    "name": "unescape-html",
    "language": "javascript",
    "patternType": "utility",
    "description": "Unescape HTML entities back to characters",
    "tags": [
      "string",
      "html"
    ],
    "code": "function unescapeHTML(str) {\n  var map = {'&amp;':'&','&lt;':'<','&gt;':'>','&quot;':'\"','&#39;':\"'\"};\n  return str.replace(/&(?:amp|lt|gt|quot|#39);/g, function(m) { return map[m]; });\n}",
    "testCode": "if (unescapeHTML('&lt;b&gt;') !== '<b>') throw new Error('tags');\nif (unescapeHTML('a&amp;b') !== 'a&b') throw new Error('amp');\nif (unescapeHTML('hello') !== 'hello') throw new Error('noop');"
  },
  {
    "name": "reverse-string",
    "language": "javascript",
    "patternType": "utility",
    "description": "Reverse a string",
    "tags": [
      "string",
      "utility"
    ],
    "code": "function reverseString(str) {\n  return str.split('').reverse().join('');\n}",
    "testCode": "if (reverseString('hello') !== 'olleh') throw new Error('basic');\nif (reverseString('') !== '') throw new Error('empty');\nif (reverseString('a') !== 'a') throw new Error('single');"
  },
  {
    "name": "word-count",
    "language": "javascript",
    "patternType": "utility",
    "description": "Count words in a string",
    "tags": [
      "string",
      "utility"
    ],
    "code": "function wordCount(str) {\n  var trimmed = str.trim();\n  if (!trimmed) return 0;\n  return trimmed.split(/\\s+/).length;\n}",
    "testCode": "if (wordCount('hello world') !== 2) throw new Error('two');\nif (wordCount('  one  ') !== 1) throw new Error('padded');\nif (wordCount('') !== 0) throw new Error('empty');\nif (wordCount('a b c d') !== 4) throw new Error('four');"
  },
  {
    "name": "title-case",
    "language": "javascript",
    "patternType": "utility",
    "description": "Convert string to Title Case",
    "tags": [
      "string",
      "utility",
      "case"
    ],
    "code": "function titleCase(str) {\n  return str.replace(/\\b\\w/g, function(c) { return c.toUpperCase(); });\n}",
    "testCode": "if (titleCase('hello world') !== 'Hello World') throw new Error('basic');\nif (titleCase('foo bar baz') !== 'Foo Bar Baz') throw new Error('three');"
  },
  {
    "name": "repeat-string",
    "language": "javascript",
    "patternType": "utility",
    "description": "Repeat a string n times",
    "tags": [
      "string",
      "utility"
    ],
    "code": "function repeatString(str, n) {\n  var result = '';\n  for (var i = 0; i < n; i++) result += str;\n  return result;\n}",
    "testCode": "if (repeatString('ab', 3) !== 'ababab') throw new Error('basic');\nif (repeatString('x', 0) !== '') throw new Error('zero');\nif (repeatString('', 5) !== '') throw new Error('empty');"
  },
  {
    "name": "is-palindrome",
    "language": "javascript",
    "patternType": "utility",
    "description": "Check if string is a palindrome",
    "tags": [
      "string",
      "utility",
      "validation"
    ],
    "code": "function isPalindrome(str) {\n  var clean = str.toLowerCase().replace(/[^a-z0-9]/g, '');\n  return clean === clean.split('').reverse().join('');\n}",
    "testCode": "if (!isPalindrome('racecar')) throw new Error('basic');\nif (!isPalindrome('A man a plan a canal Panama')) throw new Error('sentence');\nif (isPalindrome('hello')) throw new Error('not palindrome');\nif (!isPalindrome('')) throw new Error('empty');"
  },
  {
    "name": "count-occurrences",
    "language": "javascript",
    "patternType": "utility",
    "description": "Count occurrences of substring in string",
    "tags": [
      "string",
      "utility"
    ],
    "code": "function countOccurrences(str, sub) {\n  if (!sub.length) return 0;\n  var count = 0, pos = 0;\n  while ((pos = str.indexOf(sub, pos)) !== -1) { count++; pos += sub.length; }\n  return count;\n}",
    "testCode": "if (countOccurrences('abcabc', 'abc') !== 2) throw new Error('two');\nif (countOccurrences('hello', 'x') !== 0) throw new Error('none');\nif (countOccurrences('aaa', 'a') !== 3) throw new Error('single');"
  },
  {
    "name": "pad-string",
    "language": "javascript",
    "patternType": "utility",
    "description": "Pad string to target length",
    "tags": [
      "string",
      "utility"
    ],
    "code": "function padString(str, len, ch, right) {\n  ch = ch || ' ';\n  while (str.length < len) {\n    str = right ? str + ch : ch + str;\n  }\n  return str;\n}",
    "testCode": "if (padString('5', 3, '0') !== '005') throw new Error('left');\nif (padString('5', 3, '0', true) !== '500') throw new Error('right');\nif (padString('hello', 3) !== 'hello') throw new Error('longer');"
  },
  {
    "name": "chunk",
    "language": "javascript",
    "patternType": "utility",
    "description": "Split array into chunks of given size",
    "tags": [
      "array",
      "utility"
    ],
    "code": "function chunk(arr, size) {\n  var result = [];\n  for (var i = 0; i < arr.length; i += size) {\n    result.push(arr.slice(i, i + size));\n  }\n  return result;\n}",
    "testCode": "if (JSON.stringify(chunk([1,2,3,4,5], 2)) !== '[[1,2],[3,4],[5]]') throw new Error('basic');\nif (JSON.stringify(chunk([], 3)) !== '[]') throw new Error('empty');\nif (JSON.stringify(chunk([1], 5)) !== '[[1]]') throw new Error('small');"
  },
  {
    "name": "compact",
    "language": "javascript",
    "patternType": "utility",
    "description": "Remove falsy values from array",
    "tags": [
      "array",
      "utility",
      "filter"
    ],
    "code": "function compact(arr) {\n  return arr.filter(Boolean);\n}",
    "testCode": "var r = compact([0, 1, false, 2, '', 3, null, undefined]);\nif (JSON.stringify(r) !== '[1,2,3]') throw new Error('basic: ' + JSON.stringify(r));\nif (compact([]).length !== 0) throw new Error('empty');"
  },
  {
    "name": "difference",
    "language": "javascript",
    "patternType": "utility",
    "description": "Get items in first array not in second",
    "tags": [
      "array",
      "utility",
      "set"
    ],
    "code": "function difference(a, b) {\n  var set = new Set(b);\n  return a.filter(function(x) { return !set.has(x); });\n}",
    "testCode": "if (JSON.stringify(difference([1,2,3], [2,3,4])) !== '[1]') throw new Error('basic');\nif (difference([1,2], [1,2]).length !== 0) throw new Error('same');\nif (JSON.stringify(difference([1,2,3], [])) !== '[1,2,3]') throw new Error('empty b');"
  },
  {
    "name": "intersection",
    "language": "javascript",
    "patternType": "utility",
    "description": "Get items present in both arrays",
    "tags": [
      "array",
      "utility",
      "set"
    ],
    "code": "function intersection(a, b) {\n  var set = new Set(b);\n  return a.filter(function(x) { return set.has(x); });\n}",
    "testCode": "if (JSON.stringify(intersection([1,2,3], [2,3,4])) !== '[2,3]') throw new Error('basic');\nif (intersection([1,2], [3,4]).length !== 0) throw new Error('none');"
  },
  {
    "name": "union",
    "language": "javascript",
    "patternType": "utility",
    "description": "Get unique items from both arrays",
    "tags": [
      "array",
      "utility",
      "set"
    ],
    "code": "function union(a, b) {\n  return Array.from(new Set(a.concat(b)));\n}",
    "testCode": "var r = union([1,2,3], [2,3,4]);\nif (JSON.stringify(r.sort()) !== '[1,2,3,4]') throw new Error('basic');\nif (union([], []).length !== 0) throw new Error('empty');"
  },
  {
    "name": "zip",
    "language": "javascript",
    "patternType": "utility",
    "description": "Zip multiple arrays into array of tuples",
    "tags": [
      "array",
      "utility"
    ],
    "code": "function zip() {\n  var arrays = Array.prototype.slice.call(arguments);\n  var len = Math.min.apply(null, arrays.map(function(a) { return a.length; }));\n  var result = [];\n  for (var i = 0; i < len; i++) result.push(arrays.map(function(a) { return a[i]; }));\n  return result;\n}",
    "testCode": "var r = zip([1,2,3], ['a','b','c']);\nif (JSON.stringify(r) !== '[[1,\"a\"],[2,\"b\"],[3,\"c\"]]') throw new Error('basic');\nif (zip([1], [2,3]).length !== 1) throw new Error('unequal');"
  },
  {
    "name": "unzip",
    "language": "javascript",
    "patternType": "utility",
    "description": "Unzip array of tuples into separate arrays",
    "tags": [
      "array",
      "utility"
    ],
    "code": "function unzip(pairs) {\n  if (!pairs.length) return [];\n  return pairs[0].map(function(_, i) {\n    return pairs.map(function(p) { return p[i]; });\n  });\n}",
    "testCode": "var r = unzip([[1,'a'],[2,'b'],[3,'c']]);\nif (JSON.stringify(r) !== '[[1,2,3],[\"a\",\"b\",\"c\"]]') throw new Error('basic');\nif (unzip([]).length !== 0) throw new Error('empty');"
  },
  {
    "name": "range",
    "language": "javascript",
    "patternType": "utility",
    "description": "Generate array of numbers in range",
    "tags": [
      "array",
      "utility",
      "generator"
    ],
    "code": "function range(start, end, step) {\n  step = step || 1;\n  var result = [];\n  if (step > 0) { for (var i = start; i < end; i += step) result.push(i); }\n  else { for (var i = start; i > end; i += step) result.push(i); }\n  return result;\n}",
    "testCode": "if (JSON.stringify(range(0, 5)) !== '[0,1,2,3,4]') throw new Error('basic');\nif (JSON.stringify(range(0, 10, 2)) !== '[0,2,4,6,8]') throw new Error('step');\nif (JSON.stringify(range(5, 0, -1)) !== '[5,4,3,2,1]') throw new Error('neg');"
  },
  {
    "name": "unique",
    "language": "javascript",
    "patternType": "utility",
    "description": "Get unique values from array",
    "tags": [
      "array",
      "utility",
      "set"
    ],
    "code": "function unique(arr) {\n  return Array.from(new Set(arr));\n}",
    "testCode": "if (JSON.stringify(unique([1,2,2,3,3,3])) !== '[1,2,3]') throw new Error('basic');\nif (unique([]).length !== 0) throw new Error('empty');\nif (unique([1]).length !== 1) throw new Error('single');"
  },
  {
    "name": "partition",
    "language": "javascript",
    "patternType": "utility",
    "description": "Split array into two based on predicate",
    "tags": [
      "array",
      "utility"
    ],
    "code": "function partition(arr, fn) {\n  var pass = [], fail = [];\n  for (var i = 0; i < arr.length; i++) {\n    (fn(arr[i]) ? pass : fail).push(arr[i]);\n  }\n  return [pass, fail];\n}",
    "testCode": "var r = partition([1,2,3,4,5], function(n) { return n % 2 === 0; });\nif (JSON.stringify(r[0]) !== '[2,4]') throw new Error('evens');\nif (JSON.stringify(r[1]) !== '[1,3,5]') throw new Error('odds');"
  },
  {
    "name": "take",
    "language": "javascript",
    "patternType": "utility",
    "description": "Take first n elements from array",
    "tags": [
      "array",
      "utility"
    ],
    "code": "function take(arr, n) {\n  return arr.slice(0, n);\n}",
    "testCode": "if (JSON.stringify(take([1,2,3,4], 2)) !== '[1,2]') throw new Error('basic');\nif (take([], 5).length !== 0) throw new Error('empty');\nif (JSON.stringify(take([1,2], 5)) !== '[1,2]') throw new Error('over');"
  },
  {
    "name": "drop",
    "language": "javascript",
    "patternType": "utility",
    "description": "Drop first n elements from array",
    "tags": [
      "array",
      "utility"
    ],
    "code": "function drop(arr, n) {\n  return arr.slice(n);\n}",
    "testCode": "if (JSON.stringify(drop([1,2,3,4], 2)) !== '[3,4]') throw new Error('basic');\nif (drop([], 5).length !== 0) throw new Error('empty');"
  },
  {
    "name": "last",
    "language": "javascript",
    "patternType": "utility",
    "description": "Get last element of array",
    "tags": [
      "array",
      "utility"
    ],
    "code": "function last(arr) {\n  return arr.length > 0 ? arr[arr.length - 1] : undefined;\n}",
    "testCode": "if (last([1,2,3]) !== 3) throw new Error('basic');\nif (last([]) !== undefined) throw new Error('empty');\nif (last([42]) !== 42) throw new Error('single');"
  },
  {
    "name": "without",
    "language": "javascript",
    "patternType": "utility",
    "description": "Remove specified values from array",
    "tags": [
      "array",
      "utility",
      "filter"
    ],
    "code": "function without(arr) {\n  var values = Array.prototype.slice.call(arguments, 1);\n  var set = new Set(values);\n  return arr.filter(function(x) { return !set.has(x); });\n}",
    "testCode": "if (JSON.stringify(without([1,2,3,4], 2, 4)) !== '[1,3]') throw new Error('basic');\nif (without([1,1,1], 1).length !== 0) throw new Error('all');"
  },
  {
    "name": "sample-array",
    "language": "javascript",
    "patternType": "utility",
    "description": "Get random sample of n items from array",
    "tags": [
      "array",
      "utility",
      "random"
    ],
    "code": "function sampleArray(arr, n) {\n  var shuffled = arr.slice();\n  for (var i = shuffled.length - 1; i > 0; i--) {\n    var j = Math.floor(Math.random() * (i + 1));\n    var tmp = shuffled[i]; shuffled[i] = shuffled[j]; shuffled[j] = tmp;\n  }\n  return shuffled.slice(0, n || 1);\n}",
    "testCode": "var s = sampleArray([1,2,3,4,5], 3);\nif (s.length !== 3) throw new Error('length');\nif (!s.every(function(x) { return [1,2,3,4,5].indexOf(x) >= 0; })) throw new Error('items');\nif (sampleArray([], 3).length !== 0) throw new Error('empty');"
  },
  {
    "name": "pick",
    "language": "javascript",
    "patternType": "utility",
    "description": "Pick specified keys from object",
    "tags": [
      "object",
      "utility"
    ],
    "code": "function pick(obj, keys) {\n  var result = {};\n  for (var i = 0; i < keys.length; i++) {\n    if (keys[i] in obj) result[keys[i]] = obj[keys[i]];\n  }\n  return result;\n}",
    "testCode": "var r = pick({a:1,b:2,c:3}, ['a','c']);\nif (r.a !== 1 || r.c !== 3) throw new Error('picked');\nif ('b' in r) throw new Error('excluded');"
  },
  {
    "name": "omit",
    "language": "javascript",
    "patternType": "utility",
    "description": "Omit specified keys from object",
    "tags": [
      "object",
      "utility"
    ],
    "code": "function omit(obj, keys) {\n  var set = new Set(keys);\n  var result = {};\n  for (var k in obj) {\n    if (obj.hasOwnProperty(k) && !set.has(k)) result[k] = obj[k];\n  }\n  return result;\n}",
    "testCode": "var r = omit({a:1,b:2,c:3}, ['b']);\nif (r.a !== 1 || r.c !== 3) throw new Error('kept');\nif ('b' in r) throw new Error('omitted');"
  },
  {
    "name": "deep-merge",
    "language": "javascript",
    "patternType": "utility",
    "description": "Deep merge multiple objects",
    "tags": [
      "object",
      "utility",
      "merge"
    ],
    "code": "function deepMerge(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      if (!source.hasOwnProperty(key)) continue;\n      if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n        target[key] = deepMerge(target[key] || {}, source[key]);\n      } else {\n        target[key] = source[key];\n      }\n    }\n  }\n  return target;\n}",
    "testCode": "var r = deepMerge({a:1, b:{c:2, d:3}}, {b:{c:9, e:4}});\nif (r.a !== 1) throw new Error('a');\nif (r.b.c !== 9) throw new Error('override');\nif (r.b.d !== 3) throw new Error('keep');\nif (r.b.e !== 4) throw new Error('add');"
  },
  {
    "name": "map-values",
    "language": "javascript",
    "patternType": "utility",
    "description": "Map over object values",
    "tags": [
      "object",
      "utility",
      "transform"
    ],
    "code": "function mapValues(obj, fn) {\n  var result = {};\n  var keys = Object.keys(obj);\n  for (var i = 0; i < keys.length; i++) {\n    result[keys[i]] = fn(obj[keys[i]], keys[i]);\n  }\n  return result;\n}",
    "testCode": "var r = mapValues({a:1,b:2}, function(v) { return v * 2; });\nif (r.a !== 2 || r.b !== 4) throw new Error('doubled');"
  },
  {
    "name": "map-keys",
    "language": "javascript",
    "patternType": "utility",
    "description": "Map over object keys",
    "tags": [
      "object",
      "utility",
      "transform"
    ],
    "code": "function mapKeys(obj, fn) {\n  var result = {};\n  var keys = Object.keys(obj);\n  for (var i = 0; i < keys.length; i++) {\n    result[fn(keys[i], obj[keys[i]])] = obj[keys[i]];\n  }\n  return result;\n}",
    "testCode": "var r = mapKeys({a:1,b:2}, function(k) { return k.toUpperCase(); });\nif (r.A !== 1 || r.B !== 2) throw new Error('mapped');\nif ('a' in r) throw new Error('old key');"
  },
  {
    "name": "invert",
    "language": "javascript",
    "patternType": "utility",
    "description": "Swap keys and values in object",
    "tags": [
      "object",
      "utility"
    ],
    "code": "function invert(obj) {\n  var result = {};\n  var keys = Object.keys(obj);\n  for (var i = 0; i < keys.length; i++) {\n    result[obj[keys[i]]] = keys[i];\n  }\n  return result;\n}",
    "testCode": "var r = invert({a:'x', b:'y'});\nif (r.x !== 'a' || r.y !== 'b') throw new Error('inverted');"
  },
  {
    "name": "defaults",
    "language": "javascript",
    "patternType": "utility",
    "description": "Set default values without overriding existing",
    "tags": [
      "object",
      "utility"
    ],
    "code": "function defaults(obj) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      if (source.hasOwnProperty(key) && obj[key] === undefined) {\n        obj[key] = source[key];\n      }\n    }\n  }\n  return obj;\n}",
    "testCode": "var r = defaults({a:1}, {a:9, b:2}, {c:3});\nif (r.a !== 1) throw new Error('no override');\nif (r.b !== 2) throw new Error('added b');\nif (r.c !== 3) throw new Error('added c');"
  },
  {
    "name": "freeze-deep",
    "language": "javascript",
    "patternType": "utility",
    "description": "Recursively freeze object",
    "tags": [
      "object",
      "utility",
      "immutable"
    ],
    "code": "function freezeDeep(obj) {\n  Object.freeze(obj);\n  Object.keys(obj).forEach(function(key) {\n    if (obj[key] && typeof obj[key] === 'object' && !Object.isFrozen(obj[key])) {\n      freezeDeep(obj[key]);\n    }\n  });\n  return obj;\n}",
    "testCode": "var o = freezeDeep({a:1, b:{c:2}});\nif (!Object.isFrozen(o)) throw new Error('frozen');\nif (!Object.isFrozen(o.b)) throw new Error('deep frozen');"
  },
  {
    "name": "has-path",
    "language": "javascript",
    "patternType": "utility",
    "description": "Check if object has nested path",
    "tags": [
      "object",
      "utility",
      "path"
    ],
    "code": "function hasPath(obj, path) {\n  var keys = path.split('.');\n  var current = obj;\n  for (var i = 0; i < keys.length; i++) {\n    if (current == null || !current.hasOwnProperty(keys[i])) return false;\n    current = current[keys[i]];\n  }\n  return true;\n}",
    "testCode": "if (!hasPath({a:{b:{c:1}}}, 'a.b.c')) throw new Error('deep');\nif (hasPath({a:1}, 'a.b')) throw new Error('missing');\nif (hasPath({}, 'x')) throw new Error('empty');"
  },
  {
    "name": "rename-keys",
    "language": "javascript",
    "patternType": "utility",
    "description": "Rename object keys via mapping",
    "tags": [
      "object",
      "utility",
      "transform"
    ],
    "code": "function renameKeys(obj, keyMap) {\n  var result = {};\n  var keys = Object.keys(obj);\n  for (var i = 0; i < keys.length; i++) {\n    var newKey = keyMap[keys[i]] || keys[i];\n    result[newKey] = obj[keys[i]];\n  }\n  return result;\n}",
    "testCode": "var r = renameKeys({a:1, b:2}, {a:'x'});\nif (r.x !== 1) throw new Error('renamed');\nif (r.b !== 2) throw new Error('kept');\nif ('a' in r) throw new Error('old key');"
  },
  {
    "name": "clamp",
    "language": "javascript",
    "patternType": "utility",
    "description": "Clamp number between min and max",
    "tags": [
      "math",
      "utility"
    ],
    "code": "function clamp(val, min, max) {\n  return Math.min(Math.max(val, min), max);\n}",
    "testCode": "if (clamp(5, 0, 10) !== 5) throw new Error('in range');\nif (clamp(-5, 0, 10) !== 0) throw new Error('below');\nif (clamp(15, 0, 10) !== 10) throw new Error('above');"
  },
  {
    "name": "lerp",
    "language": "javascript",
    "patternType": "utility",
    "description": "Linear interpolation between two values",
    "tags": [
      "math",
      "utility",
      "animation"
    ],
    "code": "function lerp(a, b, t) {\n  return a + (b - a) * t;\n}",
    "testCode": "if (lerp(0, 10, 0.5) !== 5) throw new Error('mid');\nif (lerp(0, 10, 0) !== 0) throw new Error('start');\nif (lerp(0, 10, 1) !== 10) throw new Error('end');"
  },
  {
    "name": "fibonacci",
    "language": "javascript",
    "patternType": "algorithm",
    "description": "Get nth Fibonacci number iteratively",
    "tags": [
      "math",
      "algorithm"
    ],
    "code": "function fibonacci(n) {\n  if (n <= 1) return n;\n  var a = 0, b = 1;\n  for (var i = 2; i <= n; i++) { var t = b; b = a + b; a = t; }\n  return b;\n}",
    "testCode": "if (fibonacci(0) !== 0) throw new Error('f0');\nif (fibonacci(1) !== 1) throw new Error('f1');\nif (fibonacci(10) !== 55) throw new Error('f10');\nif (fibonacci(20) !== 6765) throw new Error('f20');"
  },
  {
    "name": "is-prime",
    "language": "javascript",
    "patternType": "algorithm",
    "description": "Check if number is prime",
    "tags": [
      "math",
      "algorithm",
      "validation"
    ],
    "code": "function isPrime(n) {\n  if (n < 2) return false;\n  if (n < 4) return true;\n  if (n % 2 === 0 || n % 3 === 0) return false;\n  for (var i = 5; i * i <= n; i += 6) {\n    if (n % i === 0 || n % (i + 2) === 0) return false;\n  }\n  return true;\n}",
    "testCode": "if (!isPrime(2)) throw new Error('2');\nif (!isPrime(17)) throw new Error('17');\nif (isPrime(1)) throw new Error('1');\nif (isPrime(15)) throw new Error('15');"
  },
  {
    "name": "gcd",
    "language": "javascript",
    "patternType": "algorithm",
    "description": "Greatest common divisor using Euclidean algorithm",
    "tags": [
      "math",
      "algorithm"
    ],
    "code": "function gcd(a, b) {\n  a = Math.abs(a); b = Math.abs(b);\n  while (b) { var t = b; b = a % b; a = t; }\n  return a;\n}",
    "testCode": "if (gcd(12, 8) !== 4) throw new Error('12,8');\nif (gcd(7, 13) !== 1) throw new Error('coprime');\nif (gcd(0, 5) !== 5) throw new Error('zero');"
  },
  {
    "name": "factorial",
    "language": "javascript",
    "patternType": "algorithm",
    "description": "Compute factorial of n",
    "tags": [
      "math",
      "algorithm"
    ],
    "code": "function factorial(n) {\n  if (n < 0) throw new Error('negative');\n  var result = 1;\n  for (var i = 2; i <= n; i++) result *= i;\n  return result;\n}",
    "testCode": "if (factorial(0) !== 1) throw new Error('0!');\nif (factorial(5) !== 120) throw new Error('5!');\nif (factorial(1) !== 1) throw new Error('1!');\ntry { factorial(-1); throw new Error('should throw'); } catch(e) { if (e.message === 'should throw') throw e; }"
  },
  {
    "name": "round-to",
    "language": "javascript",
    "patternType": "utility",
    "description": "Round number to specified decimal places",
    "tags": [
      "math",
      "utility"
    ],
    "code": "function roundTo(num, places) {\n  var factor = Math.pow(10, places);\n  return Math.round((num + Number.EPSILON) * factor) / factor;\n}",
    "testCode": "if (roundTo(3.14159, 2) !== 3.14) throw new Error('2 places');\nif (roundTo(1.005, 2) !== 1.01) throw new Error('rounding');\nif (roundTo(2.675, 2) !== 2.68) throw new Error('banker');\nif (roundTo(5, 0) !== 5) throw new Error('integer');"
  },
  {
    "name": "random-int",
    "language": "javascript",
    "patternType": "utility",
    "description": "Random integer between min and max inclusive",
    "tags": [
      "math",
      "utility",
      "random"
    ],
    "code": "function randomInt(min, max) {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}",
    "testCode": "for (var i = 0; i < 100; i++) {\n  var r = randomInt(1, 10);\n  if (r < 1 || r > 10) throw new Error('out of range: ' + r);\n  if (!Number.isInteger(r)) throw new Error('not int');\n}"
  },
  {
    "name": "sum",
    "language": "javascript",
    "patternType": "utility",
    "description": "Sum array of numbers",
    "tags": [
      "math",
      "utility",
      "array"
    ],
    "code": "function sum(arr) {\n  var total = 0;\n  for (var i = 0; i < arr.length; i++) total += arr[i];\n  return total;\n}",
    "testCode": "if (sum([1,2,3,4]) !== 10) throw new Error('basic');\nif (sum([]) !== 0) throw new Error('empty');\nif (sum([-1, 1]) !== 0) throw new Error('negative');"
  },
  {
    "name": "median",
    "language": "javascript",
    "patternType": "utility",
    "description": "Calculate median of number array",
    "tags": [
      "math",
      "utility",
      "statistics"
    ],
    "code": "function median(arr) {\n  if (!arr.length) return undefined;\n  var sorted = arr.slice().sort(function(a,b) { return a - b; });\n  var mid = sorted.length >>> 1;\n  return sorted.length % 2 ? sorted[mid] : (sorted[mid-1] + sorted[mid]) / 2;\n}",
    "testCode": "if (median([3,1,2]) !== 2) throw new Error('odd');\nif (median([4,1,3,2]) !== 2.5) throw new Error('even');\nif (median([5]) !== 5) throw new Error('single');\nif (median([]) !== undefined) throw new Error('empty');"
  },
  {
    "name": "sleep",
    "language": "javascript",
    "patternType": "utility",
    "description": "Promise-based delay function",
    "tags": [
      "async",
      "utility",
      "promise"
    ],
    "code": "function sleep(ms) {\n  return new Promise(function(resolve) { setTimeout(resolve, ms); });\n}",
    "testCode": "if (typeof sleep(1).then !== 'function') throw new Error('not promise');\nvar start = Date.now();\nsleep(10).then(function() {\n  if (Date.now() - start < 5) throw new Error('too fast');\n});"
  },
  {
    "name": "promise-timeout",
    "language": "javascript",
    "patternType": "utility",
    "description": "Wrap promise with timeout",
    "tags": [
      "async",
      "utility",
      "promise"
    ],
    "code": "function promiseTimeout(promise, ms) {\n  var timeout = new Promise(function(_, reject) {\n    setTimeout(function() { reject(new Error('timeout')); }, ms);\n  });\n  return Promise.race([promise, timeout]);\n}",
    "testCode": "promiseTimeout(Promise.resolve(42), 100).then(function(v) {\n  if (v !== 42) throw new Error('value');\n});"
  },
  {
    "name": "deferred",
    "language": "javascript",
    "patternType": "utility",
    "description": "Create deferred promise with external resolve/reject",
    "tags": [
      "async",
      "utility",
      "promise"
    ],
    "code": "function deferred() {\n  var resolve, reject;\n  var promise = new Promise(function(res, rej) { resolve = res; reject = rej; });\n  return { promise: promise, resolve: resolve, reject: reject };\n}",
    "testCode": "var d = deferred();\nif (typeof d.promise.then !== 'function') throw new Error('promise');\nif (typeof d.resolve !== 'function') throw new Error('resolve');\nif (typeof d.reject !== 'function') throw new Error('reject');\nd.promise.then(function(v) { if (v !== 'ok') throw new Error('value'); });\nd.resolve('ok');"
  },
  {
    "name": "p-map",
    "language": "javascript",
    "patternType": "utility",
    "description": "Parallel map with concurrency limit",
    "tags": [
      "async",
      "utility",
      "concurrency"
    ],
    "code": "function pMap(items, fn, concurrency) {\n  concurrency = concurrency || Infinity;\n  var results = new Array(items.length);\n  var index = 0;\n  function worker() {\n    var work = Promise.resolve();\n    while (index < items.length) {\n      work = (function(i) {\n        return work.then(function() { return fn(items[i], i); })\n          .then(function(r) { results[i] = r; });\n      })(index++);\n    }\n    return work;\n  }\n  var workers = [];\n  for (var i = 0; i < Math.min(concurrency, items.length); i++) workers.push(worker());\n  return Promise.all(workers).then(function() { return results; });\n}",
    "testCode": "pMap([1,2,3], function(x) { return Promise.resolve(x * 2); }, 2).then(function(r) {\n  if (JSON.stringify(r) !== '[2,4,6]') throw new Error('result: ' + JSON.stringify(r));\n});"
  },
  {
    "name": "stack",
    "language": "javascript",
    "patternType": "data-structure",
    "description": "Stack with push, pop, peek operations",
    "tags": [
      "data-structure",
      "stack"
    ],
    "code": "function Stack() {\n  this.items = [];\n}\nStack.prototype.push = function(item) { this.items.push(item); };\nStack.prototype.pop = function() { return this.items.pop(); };\nStack.prototype.peek = function() { return this.items[this.items.length - 1]; };\nStack.prototype.isEmpty = function() { return this.items.length === 0; };\nStack.prototype.size = function() { return this.items.length; };",
    "testCode": "var s = new Stack();\ns.push(1); s.push(2); s.push(3);\nif (s.peek() !== 3) throw new Error('peek');\nif (s.pop() !== 3) throw new Error('pop');\nif (s.size() !== 2) throw new Error('size');\nif (s.isEmpty()) throw new Error('not empty');"
  },
  {
    "name": "min-heap",
    "language": "javascript",
    "patternType": "data-structure",
    "description": "Min-heap with insert and extractMin",
    "tags": [
      "data-structure",
      "heap",
      "priority-queue"
    ],
    "code": "function MinHeap() { this.data = []; }\nMinHeap.prototype.insert = function(val) {\n  this.data.push(val);\n  var i = this.data.length - 1;\n  while (i > 0) {\n    var p = (i - 1) >>> 1;\n    if (this.data[p] <= this.data[i]) break;\n    var t = this.data[p]; this.data[p] = this.data[i]; this.data[i] = t;\n    i = p;\n  }\n};\nMinHeap.prototype.extractMin = function() {\n  if (!this.data.length) return undefined;\n  var min = this.data[0], last = this.data.pop();\n  if (this.data.length > 0) {\n    this.data[0] = last;\n    var i = 0, n = this.data.length;\n    while (true) {\n      var m = i, l = 2*i+1, r = 2*i+2;\n      if (l < n && this.data[l] < this.data[m]) m = l;\n      if (r < n && this.data[r] < this.data[m]) m = r;\n      if (m === i) break;\n      var t = this.data[i]; this.data[i] = this.data[m]; this.data[m] = t;\n      i = m;\n    }\n  }\n  return min;\n};\nMinHeap.prototype.peek = function() { return this.data[0]; };",
    "testCode": "var h = new MinHeap();\nh.insert(5); h.insert(2); h.insert(8); h.insert(1);\nif (h.peek() !== 1) throw new Error('peek');\nif (h.extractMin() !== 1) throw new Error('min1');\nif (h.extractMin() !== 2) throw new Error('min2');\nif (h.extractMin() !== 5) throw new Error('min3');"
  },
  {
    "name": "linked-list",
    "language": "javascript",
    "patternType": "data-structure",
    "description": "Singly linked list",
    "tags": [
      "data-structure",
      "linked-list"
    ],
    "code": "function LinkedList() { this.head = null; this.length = 0; }\nLinkedList.prototype.push = function(val) {\n  this.head = { val: val, next: this.head };\n  this.length++;\n};\nLinkedList.prototype.pop = function() {\n  if (!this.head) return undefined;\n  var val = this.head.val;\n  this.head = this.head.next;\n  this.length--;\n  return val;\n};\nLinkedList.prototype.has = function(val) {\n  var n = this.head;\n  while (n) { if (n.val === val) return true; n = n.next; }\n  return false;\n};\nLinkedList.prototype.toArray = function() {\n  var r = [], n = this.head;\n  while (n) { r.push(n.val); n = n.next; }\n  return r;\n};",
    "testCode": "var ll = new LinkedList();\nll.push(1); ll.push(2); ll.push(3);\nif (ll.length !== 3) throw new Error('length');\nif (!ll.has(2)) throw new Error('has');\nif (ll.pop() !== 3) throw new Error('pop');\nif (JSON.stringify(ll.toArray()) !== '[2,1]') throw new Error('toArray');"
  },
  {
    "name": "priority-queue",
    "language": "javascript",
    "patternType": "data-structure",
    "description": "Priority queue using min-heap",
    "tags": [
      "data-structure",
      "priority-queue",
      "heap"
    ],
    "code": "function PriorityQueue() { this.heap = []; }\nPriorityQueue.prototype.enqueue = function(value, priority) {\n  this.heap.push({value: value, priority: priority});\n  var i = this.heap.length - 1;\n  while (i > 0) {\n    var p = (i-1) >>> 1;\n    if (this.heap[p].priority <= this.heap[i].priority) break;\n    var t = this.heap[p]; this.heap[p] = this.heap[i]; this.heap[i] = t;\n    i = p;\n  }\n};\nPriorityQueue.prototype.dequeue = function() {\n  if (!this.heap.length) return undefined;\n  var top = this.heap[0], last = this.heap.pop();\n  if (this.heap.length > 0) {\n    this.heap[0] = last;\n    var i = 0, n = this.heap.length;\n    while (true) {\n      var m = i, l = 2*i+1, r = 2*i+2;\n      if (l < n && this.heap[l].priority < this.heap[m].priority) m = l;\n      if (r < n && this.heap[r].priority < this.heap[m].priority) m = r;\n      if (m === i) break;\n      var t = this.heap[i]; this.heap[i] = this.heap[m]; this.heap[m] = t;\n      i = m;\n    }\n  }\n  return top.value;\n};",
    "testCode": "var pq = new PriorityQueue();\npq.enqueue('low', 3); pq.enqueue('high', 1); pq.enqueue('med', 2);\nif (pq.dequeue() !== 'high') throw new Error('first');\nif (pq.dequeue() !== 'med') throw new Error('second');\nif (pq.dequeue() !== 'low') throw new Error('third');"
  },
  {
    "name": "bloom-filter",
    "language": "javascript",
    "patternType": "data-structure",
    "description": "Bloom filter for probabilistic set membership",
    "tags": [
      "data-structure",
      "bloom-filter",
      "probabilistic"
    ],
    "code": "function BloomFilter(size) {\n  this.size = size || 256;\n  this.bits = new Uint8Array(this.size);\n}\nBloomFilter.prototype._hashes = function(val) {\n  var str = String(val), h1 = 0, h2 = 0;\n  for (var i = 0; i < str.length; i++) {\n    h1 = (h1 * 31 + str.charCodeAt(i)) % this.size;\n    h2 = (h2 * 37 + str.charCodeAt(i)) % this.size;\n  }\n  return [h1, h2, (h1 + h2) % this.size];\n};\nBloomFilter.prototype.add = function(val) {\n  var h = this._hashes(val);\n  for (var i = 0; i < h.length; i++) this.bits[h[i]] = 1;\n};\nBloomFilter.prototype.has = function(val) {\n  var h = this._hashes(val);\n  for (var i = 0; i < h.length; i++) { if (!this.bits[h[i]]) return false; }\n  return true;\n};",
    "testCode": "var bf = new BloomFilter(256);\nbf.add('hello'); bf.add('world');\nif (!bf.has('hello')) throw new Error('has hello');\nif (!bf.has('world')) throw new Error('has world');"
  },
  {
    "name": "curry",
    "language": "javascript",
    "patternType": "utility",
    "description": "Curry a function for partial application",
    "tags": [
      "functional",
      "utility"
    ],
    "code": "function curry(fn) {\n  return function curried() {\n    var args = Array.prototype.slice.call(arguments);\n    if (args.length >= fn.length) return fn.apply(this, args);\n    return function() {\n      return curried.apply(this, args.concat(Array.prototype.slice.call(arguments)));\n    };\n  };\n}",
    "testCode": "var add = curry(function(a, b, c) { return a + b + c; });\nif (add(1, 2, 3) !== 6) throw new Error('all');\nif (add(1)(2)(3) !== 6) throw new Error('curried');\nif (add(1, 2)(3) !== 6) throw new Error('partial');"
  },
  {
    "name": "compose",
    "language": "javascript",
    "patternType": "utility",
    "description": "Compose functions right-to-left",
    "tags": [
      "functional",
      "utility"
    ],
    "code": "function compose() {\n  var fns = Array.prototype.slice.call(arguments);\n  return function(input) {\n    return fns.reduceRight(function(val, fn) { return fn(val); }, input);\n  };\n}",
    "testCode": "var double = function(x) { return x * 2; };\nvar inc = function(x) { return x + 1; };\nvar transform = compose(String, inc, double);\nif (transform(5) !== '11') throw new Error('compose: ' + transform(5));"
  },
  {
    "name": "partial",
    "language": "javascript",
    "patternType": "utility",
    "description": "Partially apply arguments to function",
    "tags": [
      "functional",
      "utility"
    ],
    "code": "function partial(fn) {\n  var preset = Array.prototype.slice.call(arguments, 1);\n  return function() {\n    return fn.apply(this, preset.concat(Array.prototype.slice.call(arguments)));\n  };\n}",
    "testCode": "var add = function(a, b, c) { return a + b + c; };\nvar add10 = partial(add, 10);\nif (add10(2, 3) !== 15) throw new Error('partial');\nvar add10and20 = partial(add, 10, 20);\nif (add10and20(3) !== 33) throw new Error('two');"
  },
  {
    "name": "once",
    "language": "javascript",
    "patternType": "utility",
    "description": "Ensure function is only called once",
    "tags": [
      "functional",
      "utility"
    ],
    "code": "function once(fn) {\n  var called = false, result;\n  return function() {\n    if (!called) { called = true; result = fn.apply(this, arguments); }\n    return result;\n  };\n}",
    "testCode": "var count = 0;\nvar inc = once(function() { return ++count; });\nif (inc() !== 1) throw new Error('first');\nif (inc() !== 1) throw new Error('cached');\nif (count !== 1) throw new Error('called once');"
  },
  {
    "name": "negate",
    "language": "javascript",
    "patternType": "utility",
    "description": "Create function that negates predicate result",
    "tags": [
      "functional",
      "utility"
    ],
    "code": "function negate(fn) {\n  return function() { return !fn.apply(this, arguments); };\n}",
    "testCode": "var isEven = function(n) { return n % 2 === 0; };\nvar isOdd = negate(isEven);\nif (!isOdd(3)) throw new Error('odd');\nif (isOdd(4)) throw new Error('even');"
  },
  {
    "name": "flip",
    "language": "javascript",
    "patternType": "utility",
    "description": "Reverse argument order of function",
    "tags": [
      "functional",
      "utility"
    ],
    "code": "function flip(fn) {\n  return function() {\n    return fn.apply(this, Array.prototype.slice.call(arguments).reverse());\n  };\n}",
    "testCode": "var div = function(a, b) { return a / b; };\nvar flipped = flip(div);\nif (flipped(2, 10) !== 5) throw new Error('flipped');"
  },
  {
    "name": "is-leap-year",
    "language": "javascript",
    "patternType": "utility",
    "description": "Check if year is a leap year",
    "tags": [
      "date",
      "utility",
      "validation"
    ],
    "code": "function isLeapYear(year) {\n  return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;\n}",
    "testCode": "if (!isLeapYear(2000)) throw new Error('2000');\nif (!isLeapYear(2024)) throw new Error('2024');\nif (isLeapYear(1900)) throw new Error('1900');\nif (isLeapYear(2023)) throw new Error('2023');"
  },
  {
    "name": "days-between",
    "language": "javascript",
    "patternType": "utility",
    "description": "Count days between two dates",
    "tags": [
      "date",
      "utility"
    ],
    "code": "function daysBetween(d1, d2) {\n  var ms = Math.abs(new Date(d1) - new Date(d2));\n  return Math.floor(ms / 86400000);\n}",
    "testCode": "if (daysBetween('2024-01-01', '2024-01-31') !== 30) throw new Error('jan');\nif (daysBetween('2024-01-01', '2024-01-01') !== 0) throw new Error('same');"
  },
  {
    "name": "days-in-month",
    "language": "javascript",
    "patternType": "utility",
    "description": "Get number of days in a given month",
    "tags": [
      "date",
      "utility"
    ],
    "code": "function daysInMonth(year, month) {\n  return new Date(year, month, 0).getDate();\n}",
    "testCode": "if (daysInMonth(2024, 2) !== 29) throw new Error('feb leap');\nif (daysInMonth(2023, 2) !== 28) throw new Error('feb normal');\nif (daysInMonth(2024, 1) !== 31) throw new Error('jan');"
  },
  {
    "name": "is-url",
    "language": "javascript",
    "patternType": "utility",
    "description": "Validate URL string",
    "tags": [
      "validation",
      "utility",
      "url"
    ],
    "code": "function isURL(str) {\n  try {\n    var url = new URL(str);\n    return url.protocol === 'http:' || url.protocol === 'https:';\n  } catch(e) { return false; }\n}",
    "testCode": "if (!isURL('https://example.com')) throw new Error('https');\nif (!isURL('http://example.com/path?q=1')) throw new Error('path');\nif (isURL('not-a-url')) throw new Error('invalid');\nif (isURL('ftp://x.com')) throw new Error('ftp');"
  },
  {
    "name": "is-json",
    "language": "javascript",
    "patternType": "utility",
    "description": "Check if string is valid JSON",
    "tags": [
      "validation",
      "utility",
      "json"
    ],
    "code": "function isJSON(str) {\n  try { JSON.parse(str); return true; } catch(e) { return false; }\n}",
    "testCode": "if (!isJSON('{\"a\":1}')) throw new Error('object');\nif (!isJSON('[1,2,3]')) throw new Error('array');\nif (!isJSON('\"hello\"')) throw new Error('string');\nif (isJSON('not json')) throw new Error('invalid');"
  },
  {
    "name": "luhn-check",
    "language": "javascript",
    "patternType": "algorithm",
    "description": "Luhn algorithm for credit card validation",
    "tags": [
      "validation",
      "algorithm"
    ],
    "code": "function luhnCheck(num) {\n  var str = String(num).replace(/\\D/g, '');\n  var sum = 0, alt = false;\n  for (var i = str.length - 1; i >= 0; i--) {\n    var n = parseInt(str[i], 10);\n    if (alt) { n *= 2; if (n > 9) n -= 9; }\n    sum += n;\n    alt = !alt;\n  }\n  return sum % 10 === 0;\n}",
    "testCode": "if (!luhnCheck('79927398713')) throw new Error('valid');\nif (luhnCheck('1234567890')) throw new Error('invalid');"
  },
  {
    "name": "parse-query-string",
    "language": "javascript",
    "patternType": "utility",
    "description": "Parse URL query string to object",
    "tags": [
      "http",
      "utility",
      "url"
    ],
    "code": "function parseQueryString(qs) {\n  if (!qs || qs === '?') return {};\n  return qs.replace(/^\\?/, '').split('&').reduce(function(obj, pair) {\n    var parts = pair.split('=');\n    obj[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1] || '');\n    return obj;\n  }, {});\n}",
    "testCode": "var r = parseQueryString('?foo=bar&baz=42');\nif (r.foo !== 'bar') throw new Error('foo');\nif (r.baz !== '42') throw new Error('baz');\nif (Object.keys(parseQueryString('')).length !== 0) throw new Error('empty');"
  },
  {
    "name": "build-query-string",
    "language": "javascript",
    "patternType": "utility",
    "description": "Build URL query string from object",
    "tags": [
      "http",
      "utility",
      "url"
    ],
    "code": "function buildQueryString(obj) {\n  var pairs = Object.keys(obj).filter(function(k) {\n    return obj[k] !== undefined;\n  }).map(function(k) {\n    return encodeURIComponent(k) + '=' + encodeURIComponent(obj[k]);\n  });\n  return pairs.length ? '?' + pairs.join('&') : '';\n}",
    "testCode": "var r = buildQueryString({foo: 'bar', baz: 42});\nif (!r.includes('foo=bar')) throw new Error('foo');\nif (!r.includes('baz=42')) throw new Error('baz');\nif (r[0] !== '?') throw new Error('question');\nif (buildQueryString({}) !== '') throw new Error('empty');"
  },
  {
    "name": "parse-cookie",
    "language": "javascript",
    "patternType": "utility",
    "description": "Parse cookie header string to object",
    "tags": [
      "http",
      "utility",
      "cookie"
    ],
    "code": "function parseCookie(str) {\n  if (!str) return {};\n  return str.split(';').reduce(function(obj, pair) {\n    var parts = pair.trim().split('=');\n    var key = parts[0].trim();\n    obj[key] = parts.slice(1).join('=').trim();\n    return obj;\n  }, {});\n}",
    "testCode": "var r = parseCookie('foo=bar; baz=42; name=hello');\nif (r.foo !== 'bar') throw new Error('foo');\nif (r.baz !== '42') throw new Error('baz');\nif (r.name !== 'hello') throw new Error('name');\nif (Object.keys(parseCookie('')).length !== 0) throw new Error('empty');"
  }
]