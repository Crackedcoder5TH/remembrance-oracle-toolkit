/**
 * Semantic Word Vectors for Code Search
 *
 * 200+ programming terms, each with a hand-crafted 32-dimensional vector.
 * Dimensions represent semantic axes like algorithmic, functional, concurrent, etc.
 *
 * This gives the Oracle genuine semantic understanding without an external API.
 */

const DIMENSIONS = [
  'algorithmic', 'functional', 'concurrent', 'temporal', 'network',
  'persistence', 'security', 'testing', 'data-oriented', 'control-flow',
  'error-handling', 'recursive', 'iterative', 'declarative', 'imperative',
  'compositional', 'structural', 'generative', 'destructive', 'immutable',
  'stateful', 'pure', 'low-level', 'high-level', 'io-bound',
  'memory', 'type-system', 'collection', 'mathematical', 'text-processing',
  'design-pattern', 'optimization',
];

// Each vector is 32 floats in [-1, 1] representing the term's position along each axis.
// Values are hand-tuned based on semantic meaning.
const VOCABULARY = {
  // ─── Algorithms ───
  'sort':           [.9, .1, 0, 0, 0, 0, 0, 0, .7, .3, 0, .3, .6, 0, .5, 0, 0, 0, 0, 0, 0, .2, .3, .3, 0, .2, 0, .8, .3, 0, 0, .8],
  'quicksort':      [1, .1, 0, 0, 0, 0, 0, 0, .7, .4, 0, .7, .3, 0, .6, 0, 0, 0, 0, 0, 0, .1, .4, .2, 0, .3, 0, .8, .2, 0, 0, .9],
  'mergesort':      [1, .2, 0, 0, 0, 0, 0, 0, .7, .3, 0, .8, .2, 0, .5, 0, 0, 0, 0, .3, 0, .3, .3, .3, 0, .4, 0, .8, .2, 0, 0, .7],
  'merge-sort':     [1, .2, 0, 0, 0, 0, 0, 0, .7, .3, 0, .8, .2, 0, .5, 0, 0, 0, 0, .3, 0, .3, .3, .3, 0, .4, 0, .8, .2, 0, 0, .7],
  'heapsort':       [1, .1, 0, 0, 0, 0, 0, 0, .8, .3, 0, .3, .6, 0, .6, 0, .5, 0, 0, 0, 0, .1, .5, .2, 0, .3, 0, .7, .2, 0, 0, .9],
  'bubblesort':     [.8, 0, 0, 0, 0, 0, 0, 0, .5, .3, 0, 0, .8, 0, .7, 0, 0, 0, 0, 0, 0, 0, .2, .1, 0, .1, 0, .7, .1, 0, 0, .2],
  'insertion-sort': [.8, 0, 0, 0, 0, 0, 0, 0, .5, .3, 0, 0, .8, 0, .7, 0, 0, 0, 0, 0, .1, 0, .2, .2, 0, .1, 0, .7, .1, 0, 0, .3],
  'search':         [.8, .1, 0, 0, 0, 0, 0, 0, .6, .3, 0, .2, .5, 0, .4, 0, 0, 0, 0, 0, 0, .2, .2, .3, 0, .1, 0, .7, .2, 0, 0, .5],
  'binary-search':  [.9, .1, 0, 0, 0, 0, 0, 0, .6, .4, 0, .5, .5, 0, .5, 0, 0, 0, 0, 0, 0, .3, .3, .2, 0, .1, 0, .8, .3, 0, 0, .8],
  'linear-search':  [.6, 0, 0, 0, 0, 0, 0, 0, .5, .2, 0, 0, .8, 0, .5, 0, 0, 0, 0, 0, 0, .1, .1, .2, 0, .1, 0, .7, .1, 0, 0, .1],
  'dfs':            [.9, .2, 0, 0, 0, 0, 0, 0, .5, .4, 0, .9, .1, 0, .5, 0, .4, 0, 0, 0, .3, .1, .3, .3, 0, .4, 0, .3, .2, 0, 0, .5],
  'bfs':            [.9, .1, 0, 0, 0, 0, 0, 0, .5, .4, 0, .2, .7, 0, .5, 0, .4, 0, 0, 0, .3, .1, .3, .3, 0, .3, 0, .3, .2, 0, 0, .5],
  'depth-first':    [.9, .2, 0, 0, 0, 0, 0, 0, .5, .4, 0, .9, .1, 0, .5, 0, .4, 0, 0, 0, .3, .1, .3, .3, 0, .4, 0, .3, .2, 0, 0, .5],
  'breadth-first':  [.9, .1, 0, 0, 0, 0, 0, 0, .5, .4, 0, .2, .7, 0, .5, 0, .4, 0, 0, 0, .3, .1, .3, .3, 0, .3, 0, .3, .2, 0, 0, .5],
  'dijkstra':       [1, .1, 0, 0, 0, 0, 0, 0, .6, .5, 0, .3, .6, 0, .5, 0, .5, 0, 0, 0, .3, .1, .4, .3, 0, .3, 0, .4, .5, 0, 0, .8],
  'graph':          [.7, .1, 0, 0, 0, 0, 0, 0, .8, .3, 0, .5, .3, .2, .3, 0, .8, 0, 0, 0, .2, .1, .3, .3, 0, .3, 0, .4, .3, 0, 0, .4],
  'tree':           [.6, .2, 0, 0, 0, 0, 0, 0, .8, .3, 0, .7, .2, .2, .3, 0, .9, 0, 0, 0, .2, .1, .3, .3, 0, .3, 0, .4, .2, 0, 0, .4],
  'traversal':      [.8, .2, 0, 0, 0, 0, 0, 0, .5, .5, 0, .6, .4, 0, .5, 0, .3, 0, 0, 0, .2, .1, .3, .3, 0, .2, 0, .5, .2, 0, 0, .4],
  'pivot':          [.8, 0, 0, 0, 0, 0, 0, 0, .5, .3, 0, .3, .4, 0, .5, 0, 0, 0, 0, 0, 0, 0, .3, .2, 0, .1, 0, .6, .2, 0, 0, .6],
  'partition':      [.8, .1, 0, 0, 0, 0, 0, 0, .6, .4, 0, .3, .5, 0, .5, 0, .2, 0, 0, 0, 0, .1, .3, .2, 0, .1, 0, .7, .2, 0, 0, .6],
  'swap':           [.5, 0, 0, 0, 0, 0, 0, 0, .3, .3, 0, 0, .5, 0, .8, 0, 0, 0, .3, 0, .4, 0, .5, .1, 0, .2, 0, .3, .1, 0, 0, .3],
  'compare':        [.6, .2, 0, 0, 0, 0, 0, 0, .4, .3, 0, 0, .3, 0, .4, 0, 0, 0, 0, 0, 0, .3, .2, .2, 0, 0, 0, .5, .2, 0, 0, .3],
  'hash':           [.5, .1, 0, 0, 0, .3, .5, 0, .6, .1, 0, 0, .3, 0, .3, 0, .3, .2, 0, 0, 0, .2, .4, .2, 0, .3, 0, .5, .3, 0, 0, .6],
  'dynamic-programming': [1, .2, 0, 0, 0, 0, 0, 0, .5, .5, 0, .7, .4, 0, .5, 0, 0, 0, 0, 0, .4, .1, .4, .3, 0, .6, 0, .4, .6, 0, 0, .9],

  // ─── Rate limiting / Timing ───
  'throttle':       [.2, .4, 0, .8, 0, 0, 0, 0, 0, .5, 0, 0, .3, 0, .4, .3, 0, 0, 0, 0, .7, .2, .2, .6, 0, 0, 0, 0, 0, 0, .3, .5],
  'debounce':       [.2, .4, 0, .9, 0, 0, 0, 0, 0, .5, 0, 0, .2, 0, .4, .3, 0, 0, 0, 0, .7, .2, .2, .6, 0, 0, 0, 0, 0, 0, .3, .5],
  'rate-limit':     [.2, .2, .3, .8, .3, 0, .3, 0, 0, .5, 0, 0, .3, 0, .5, .2, 0, 0, 0, 0, .6, .1, .2, .5, 0, 0, 0, 0, 0, 0, .3, .5],
  'cooldown':       [.1, .1, 0, .8, 0, 0, 0, 0, 0, .4, 0, 0, .2, 0, .4, 0, 0, 0, 0, 0, .6, 0, .1, .4, 0, 0, 0, 0, 0, 0, .2, .3],
  'interval':       [.1, .1, 0, .8, 0, 0, 0, 0, 0, .4, 0, 0, .5, 0, .5, 0, 0, 0, 0, 0, .5, 0, .2, .4, 0, 0, 0, 0, 0, 0, .1, .2],
  'timeout':        [.1, .1, .2, .8, 0, 0, 0, 0, 0, .5, .3, 0, .2, 0, .5, 0, 0, 0, 0, 0, .4, 0, .2, .4, 0, 0, 0, 0, 0, 0, .1, .2],
  'delay':          [.1, .1, 0, .8, 0, 0, 0, 0, 0, .3, 0, 0, .2, 0, .4, 0, 0, 0, 0, 0, .3, 0, .1, .4, 0, 0, 0, 0, 0, 0, .1, .2],
  'timer':          [.1, .1, 0, .9, 0, 0, 0, 0, 0, .3, 0, 0, .3, 0, .5, 0, 0, 0, 0, 0, .5, 0, .2, .4, 0, 0, 0, 0, 0, 0, .1, .2],

  // ─── Caching / Memoization ───
  'cache':          [.3, .2, 0, 0, 0, .5, 0, 0, .6, .2, 0, 0, .2, 0, .3, 0, .3, 0, 0, 0, .7, .1, .3, .5, 0, .6, 0, .4, 0, 0, .3, .8],
  'memoize':        [.3, .6, 0, 0, 0, .2, 0, 0, .4, .2, 0, .2, .1, .2, .2, .4, 0, 0, 0, 0, .5, .4, .2, .5, 0, .5, 0, .2, .2, 0, .3, .8],
  'memo':           [.3, .6, 0, 0, 0, .2, 0, 0, .4, .2, 0, .2, .1, .2, .2, .4, 0, 0, 0, 0, .5, .4, .2, .5, 0, .5, 0, .2, .2, 0, .3, .8],
  'lru':            [.4, .1, 0, .3, 0, .3, 0, 0, .7, .3, 0, 0, .3, 0, .4, 0, .4, 0, .3, 0, .7, .1, .3, .4, 0, .6, 0, .5, .1, 0, .4, .8],
  'eviction':       [.3, 0, 0, .2, 0, .2, 0, 0, .5, .3, 0, 0, .3, 0, .4, 0, .3, 0, .5, 0, .5, 0, .3, .3, 0, .5, 0, .4, .1, 0, .3, .6],
  'lookup':         [.4, .2, 0, 0, 0, .3, 0, 0, .6, .2, 0, 0, .3, 0, .3, 0, .2, 0, 0, 0, .3, .2, .2, .4, 0, .3, 0, .5, .1, 0, .1, .5],

  // ─── Data Structures ───
  'stack':          [.4, .1, 0, 0, 0, 0, 0, 0, .8, .4, 0, .3, .3, 0, .4, 0, .7, 0, 0, 0, .5, .1, .4, .3, 0, .4, 0, .6, .1, 0, .2, .3],
  'queue':          [.4, .1, .3, 0, 0, 0, 0, 0, .8, .4, 0, .1, .4, 0, .4, 0, .7, 0, 0, 0, .5, .1, .4, .3, 0, .4, 0, .6, .1, 0, .2, .3],
  'linked-list':    [.4, .1, 0, 0, 0, 0, 0, 0, .8, .3, 0, .4, .3, 0, .5, 0, .8, 0, 0, 0, .4, .1, .4, .3, 0, .5, 0, .6, .1, 0, .2, .3],
  'hashmap':        [.4, .1, 0, 0, 0, .3, 0, 0, .8, .2, 0, 0, .3, 0, .3, 0, .6, 0, 0, 0, .4, .1, .4, .4, 0, .4, 0, .7, .1, 0, .2, .6],
  'map':            [.3, .3, 0, 0, 0, .2, 0, 0, .7, .2, 0, 0, .3, .3, .3, .3, .5, 0, 0, 0, .3, .2, .3, .5, 0, .3, 0, .7, .1, 0, .2, .4],
  'set':            [.3, .2, 0, 0, 0, .2, 0, 0, .7, .2, 0, 0, .2, .2, .3, 0, .5, 0, 0, .3, .3, .2, .3, .4, 0, .3, 0, .6, .2, 0, .1, .4],
  'heap':           [.6, .1, 0, 0, 0, 0, 0, 0, .8, .3, 0, .3, .3, 0, .5, 0, .7, 0, 0, 0, .4, .1, .4, .3, 0, .4, 0, .6, .3, 0, .2, .6],
  'priority-queue': [.5, .1, .2, 0, 0, 0, 0, 0, .8, .4, 0, .2, .3, 0, .4, 0, .7, 0, 0, 0, .5, .1, .4, .3, 0, .4, 0, .6, .2, 0, .2, .5],
  'trie':           [.6, .1, 0, 0, 0, 0, 0, 0, .7, .3, 0, .5, .2, 0, .4, 0, .8, 0, 0, 0, .3, .1, .3, .3, 0, .4, 0, .5, .2, .5, .2, .5],
  'array':          [.3, .2, 0, 0, 0, 0, 0, 0, .6, .2, 0, 0, .5, 0, .4, 0, .3, 0, 0, 0, .3, .2, .3, .4, 0, .4, 0, .9, .2, 0, 0, .3],
  'list':           [.3, .2, 0, 0, 0, 0, 0, 0, .6, .2, 0, 0, .5, 0, .4, 0, .4, 0, 0, 0, .3, .2, .3, .4, 0, .3, 0, .8, .1, 0, 0, .3],
  'deque':          [.4, .1, .2, 0, 0, 0, 0, 0, .7, .3, 0, .1, .4, 0, .4, 0, .7, 0, 0, 0, .5, .1, .4, .3, 0, .4, 0, .6, .1, 0, .2, .3],
  'vector':         [.3, .1, 0, 0, 0, 0, 0, 0, .6, .2, 0, 0, .4, 0, .4, 0, .4, 0, 0, 0, .3, .1, .4, .3, 0, .4, 0, .8, .3, 0, 0, .3],
  'slice':          [.3, .2, 0, 0, 0, 0, 0, 0, .5, .2, 0, 0, .3, .2, .3, 0, .2, 0, .2, .3, .1, .2, .3, .4, 0, .2, 0, .7, .1, 0, 0, .3],

  // ─── Concurrency ───
  'async':          [.1, .3, .8, .3, 0, 0, 0, 0, 0, .5, .3, 0, .2, .3, .4, .3, 0, 0, 0, 0, .5, .1, .2, .6, .3, 0, 0, 0, 0, 0, .2, .3],
  'await':          [.1, .3, .8, .3, 0, 0, 0, 0, 0, .5, .3, 0, .2, .3, .4, .3, 0, 0, 0, 0, .5, .1, .2, .6, .3, 0, 0, 0, 0, 0, .2, .3],
  'promise':        [.1, .4, .7, .3, 0, 0, 0, 0, 0, .4, .4, 0, .1, .3, .3, .4, 0, 0, 0, .3, .3, .2, .2, .6, .2, 0, 0, 0, 0, 0, .3, .3],
  'parallel':       [.2, .2, .9, .2, 0, 0, 0, 0, .3, .3, 0, 0, .3, .2, .3, .2, 0, 0, 0, 0, .4, .1, .3, .4, .2, 0, 0, .3, 0, 0, .2, .6],
  'concurrent':     [.2, .2, .9, .2, 0, 0, 0, 0, .3, .4, .2, 0, .3, .2, .3, .2, 0, 0, 0, 0, .5, .1, .3, .4, .2, 0, 0, .3, 0, 0, .2, .5],
  'worker':         [.1, .1, .8, 0, 0, 0, 0, 0, .2, .3, .2, 0, .3, .2, .4, 0, 0, 0, 0, 0, .4, 0, .3, .4, .3, .2, 0, 0, 0, 0, .2, .4],
  'mutex':          [.2, 0, .9, 0, 0, 0, .2, 0, .2, .5, 0, 0, .2, 0, .5, 0, 0, 0, 0, 0, .8, 0, .5, .3, 0, .2, 0, 0, 0, 0, .4, .4],
  'semaphore':      [.2, 0, .9, 0, 0, 0, .2, 0, .2, .5, 0, 0, .2, 0, .5, 0, 0, 0, 0, 0, .7, 0, .5, .3, 0, .2, 0, 0, 0, 0, .4, .4],
  'channel':        [.1, .2, .8, 0, 0, 0, 0, 0, .3, .4, 0, 0, .2, .2, .3, .3, 0, 0, 0, 0, .5, .1, .3, .4, .2, 0, 0, 0, 0, 0, .3, .3],
  'pool':           [.2, .1, .7, 0, 0, 0, 0, 0, .4, .3, 0, 0, .3, .2, .4, 0, .3, 0, 0, 0, .6, 0, .3, .4, .2, .3, 0, .4, 0, 0, .3, .6],

  // ─── Error Handling ───
  'error':          [0, .1, 0, 0, 0, 0, 0, .2, 0, .4, .9, 0, 0, 0, .4, 0, 0, 0, 0, 0, .3, 0, .2, .4, 0, 0, 0, 0, 0, 0, .2, .2],
  'exception':      [0, .1, 0, 0, 0, 0, 0, .2, 0, .5, .9, 0, 0, 0, .4, 0, 0, 0, 0, 0, .3, 0, .2, .4, 0, 0, .2, 0, 0, 0, .2, .2],
  'try':            [0, .1, 0, 0, 0, 0, 0, .2, 0, .5, .8, 0, 0, 0, .5, 0, 0, 0, 0, 0, .2, 0, .2, .4, 0, 0, 0, 0, 0, 0, .1, .1],
  'catch':          [0, .1, 0, 0, 0, 0, 0, .2, 0, .5, .9, 0, 0, 0, .5, 0, 0, 0, 0, 0, .3, 0, .2, .4, 0, 0, 0, 0, 0, 0, .1, .1],
  'throw':          [0, .1, 0, 0, 0, 0, 0, .1, 0, .5, .8, 0, 0, 0, .5, 0, 0, .2, 0, 0, .3, 0, .2, .3, 0, 0, 0, 0, 0, 0, .1, .1],
  'fallback':       [0, .2, 0, 0, 0, 0, .1, 0, 0, .5, .7, 0, 0, 0, .4, .2, 0, 0, 0, 0, .3, .1, .2, .4, 0, 0, 0, 0, 0, 0, .2, .3],
  'recover':        [0, .2, 0, 0, 0, 0, .1, 0, 0, .4, .8, 0, 0, 0, .4, .2, 0, .2, 0, 0, .3, .1, .2, .4, 0, 0, 0, 0, 0, 0, .2, .3],
  'retry':          [.2, .2, .2, .5, .2, 0, 0, 0, 0, .5, .7, 0, .4, 0, .5, .2, 0, 0, 0, 0, .5, .1, .2, .5, .2, 0, 0, 0, 0, 0, .3, .4],
  'backoff':        [.2, .1, .2, .7, .2, 0, 0, 0, 0, .4, .5, 0, .3, 0, .4, 0, 0, 0, 0, 0, .4, .1, .2, .5, .2, 0, 0, 0, .2, 0, .2, .4],
  'exponential':    [.3, .1, 0, .5, 0, 0, 0, 0, .2, .3, .2, 0, .3, 0, .3, 0, 0, 0, 0, 0, .3, .1, .2, .4, 0, 0, 0, 0, .6, 0, .1, .4],

  // ─── Functional Programming ───
  'pure':           [.1, .9, 0, 0, 0, 0, 0, .3, 0, .1, 0, 0, 0, .6, .1, .4, 0, 0, 0, .7, 0, .9, .1, .5, 0, 0, .3, 0, .3, 0, .2, .3],
  'compose':        [.1, .8, 0, 0, 0, 0, 0, 0, 0, .2, 0, 0, .1, .5, .2, .9, 0, .3, 0, .3, 0, .7, .1, .6, 0, 0, .2, 0, .2, 0, .4, .3],
  'pipe':           [.1, .8, 0, 0, 0, 0, 0, 0, 0, .3, 0, 0, .1, .5, .2, .9, 0, .3, 0, .3, 0, .7, .1, .6, 0, 0, .2, 0, .2, 0, .4, .3],
  'curry':          [.1, .9, 0, 0, 0, 0, 0, 0, 0, .2, 0, 0, 0, .6, .1, .7, 0, .3, 0, .3, 0, .8, .1, .5, 0, 0, .3, 0, .2, 0, .3, .2],
  'map':            [.2, .7, 0, 0, 0, 0, 0, 0, .5, .2, 0, 0, .3, .6, .2, .4, 0, .3, 0, .4, 0, .6, .2, .5, 0, 0, .2, .7, .2, 0, .1, .3],
  'filter':         [.2, .7, 0, 0, 0, 0, 0, 0, .5, .3, 0, 0, .3, .6, .2, .4, 0, 0, .2, .4, 0, .6, .2, .5, 0, 0, .2, .7, .2, 0, .1, .3],
  'reduce':         [.3, .7, 0, 0, 0, 0, 0, 0, .5, .3, 0, .2, .4, .5, .2, .5, 0, .2, .2, .3, .2, .5, .2, .5, 0, 0, .2, .7, .3, 0, .1, .4],
  'fold':           [.3, .8, 0, 0, 0, 0, 0, 0, .4, .3, 0, .3, .3, .5, .2, .5, 0, .2, .2, .3, .2, .6, .2, .5, 0, 0, .2, .6, .3, 0, .1, .3],
  'flatmap':        [.2, .8, 0, 0, 0, 0, 0, 0, .5, .2, 0, .2, .2, .6, .1, .5, 0, .3, 0, .4, 0, .6, .2, .5, 0, 0, .2, .7, .2, 0, .1, .3],
  'functor':        [.1, .9, 0, 0, 0, 0, 0, 0, .3, .1, 0, 0, 0, .7, .1, .5, 0, .2, 0, .5, 0, .8, .1, .5, 0, 0, .5, .4, .3, 0, .3, .2],
  'monad':          [.1, .9, 0, 0, 0, 0, 0, 0, .3, .2, .3, 0, 0, .7, .1, .6, 0, .3, 0, .4, .3, .7, .1, .4, 0, 0, .5, .3, .3, 0, .4, .2],
  'lambda':         [.1, .8, 0, 0, 0, 0, 0, 0, 0, .2, 0, 0, 0, .5, .2, .4, 0, .3, 0, .3, 0, .6, .2, .5, 0, 0, .2, 0, .2, 0, .2, .2],
  'closure':        [.1, .7, 0, 0, 0, 0, 0, 0, 0, .3, 0, 0, 0, .4, .3, .4, 0, .2, 0, .2, .5, .4, .3, .5, 0, .3, .2, 0, .1, 0, .2, .2],
  'higher-order':   [.2, .9, 0, 0, 0, 0, 0, 0, .2, .2, 0, 0, 0, .5, .1, .6, 0, .3, 0, .3, 0, .6, .1, .6, 0, 0, .3, .2, .2, 0, .3, .3],
  'combinator':     [.2, .9, 0, 0, 0, 0, 0, 0, .2, .2, 0, 0, 0, .5, .1, .8, 0, .4, 0, .3, 0, .7, .1, .5, 0, 0, .3, .2, .3, 0, .3, .3],

  // ─── Data Transformation ───
  'flatten':        [.2, .4, 0, 0, 0, 0, 0, 0, .6, .2, 0, .5, .3, .3, .3, .2, .2, 0, .2, 0, 0, .3, .2, .4, 0, 0, 0, .7, .1, 0, 0, .3],
  'transform':      [.2, .4, 0, 0, 0, 0, 0, 0, .6, .2, 0, 0, .3, .3, .3, .3, 0, .4, .2, 0, .2, .3, .2, .5, 0, 0, 0, .5, .1, 0, .2, .3],
  'convert':        [.2, .3, 0, 0, 0, 0, 0, 0, .5, .2, 0, 0, .3, .2, .3, .2, 0, .3, .2, 0, .2, .3, .2, .4, 0, 0, .2, .4, .1, .2, .1, .3],
  'group':          [.3, .3, 0, 0, 0, 0, 0, 0, .7, .2, 0, 0, .4, .3, .3, .2, .2, .2, 0, 0, .2, .3, .2, .4, 0, 0, 0, .7, .2, 0, .1, .3],
  'groupby':        [.3, .4, 0, 0, 0, 0, 0, 0, .7, .2, 0, 0, .4, .4, .3, .3, .2, .2, 0, 0, .2, .3, .2, .5, 0, 0, 0, .7, .2, 0, .1, .4],
  'aggregate':      [.3, .3, 0, 0, 0, 0, 0, 0, .7, .2, 0, 0, .4, .3, .3, .2, .2, .2, .2, 0, .2, .3, .2, .4, 0, 0, 0, .6, .3, 0, .1, .4],
  'serialize':      [.1, .1, 0, 0, .2, .5, 0, 0, .5, .2, 0, 0, .2, 0, .3, 0, .2, .3, 0, 0, .2, .1, .3, .4, .3, 0, .2, .3, 0, .2, .1, .2],
  'deserialize':    [.1, .1, 0, 0, .2, .5, 0, 0, .5, .2, .2, 0, .2, 0, .3, 0, .2, 0, .3, 0, .2, .1, .3, .4, .3, 0, .2, .3, 0, .2, .1, .2],
  'parse':          [.2, .2, 0, 0, 0, .2, 0, 0, .5, .3, .2, .3, .2, .2, .3, 0, .2, 0, 0, 0, .2, .2, .3, .4, .2, 0, .2, .3, .1, .4, .1, .3],
  'format':         [.1, .2, 0, 0, 0, 0, 0, 0, .3, .2, 0, 0, .2, .3, .3, 0, 0, .3, 0, 0, .2, .2, .2, .4, 0, 0, 0, .2, .1, .5, .1, .2],

  // ─── Cloning / Immutability ───
  'clone':          [.1, .2, 0, 0, 0, 0, 0, 0, .5, .1, 0, .3, .1, .2, .3, 0, .2, .3, 0, .6, .1, .3, .3, .4, 0, .3, 0, .3, 0, 0, .1, .2],
  'deep-clone':     [.2, .2, 0, 0, 0, 0, 0, 0, .5, .2, 0, .6, .1, .2, .3, 0, .3, .3, 0, .7, .1, .3, .3, .4, 0, .4, 0, .3, 0, 0, .1, .3],
  'copy':           [.1, .1, 0, 0, 0, 0, 0, 0, .4, .1, 0, 0, .1, .1, .3, 0, .1, .2, 0, .4, .1, .2, .3, .3, 0, .3, 0, .3, 0, 0, .1, .2],
  'immutable':      [0, .5, 0, 0, 0, 0, .2, 0, .3, .1, 0, 0, 0, .5, .1, .3, 0, 0, 0, .9, 0, .6, .2, .5, 0, .2, .3, .2, 0, 0, .3, .3],
  'spread':         [.1, .3, 0, 0, 0, 0, 0, 0, .4, .1, 0, 0, .1, .4, .2, .2, 0, .2, 0, .4, .1, .3, .2, .5, 0, .2, 0, .4, 0, 0, .1, .2],
  'freeze':         [0, .2, 0, 0, 0, 0, .2, 0, .3, .1, 0, 0, 0, .3, .2, 0, 0, 0, 0, .8, 0, .3, .3, .4, 0, .2, .2, .2, 0, 0, .2, .2],

  // ─── Validation ───
  'validate':       [.1, .2, 0, 0, 0, 0, .4, .3, .3, .4, .3, 0, .2, .3, .4, 0, 0, 0, 0, 0, .2, .3, .2, .5, 0, 0, .3, .2, 0, .2, .2, .2],
  'check':          [.1, .2, 0, 0, 0, 0, .3, .3, .2, .4, .3, 0, .2, .2, .4, 0, 0, 0, 0, 0, .2, .3, .2, .4, 0, 0, .2, .2, 0, .2, .2, .2],
  'sanitize':       [0, .1, 0, 0, 0, 0, .7, .2, .2, .3, .2, 0, .2, 0, .4, 0, 0, 0, .3, 0, 0, .2, .2, .4, 0, 0, 0, .2, 0, .3, .1, .2],
  'guard':          [0, .2, 0, 0, 0, 0, .4, .2, .1, .5, .4, 0, .1, .3, .4, 0, 0, 0, 0, 0, .2, .3, .2, .4, 0, 0, .2, .1, 0, 0, .3, .3],
  'assert':         [0, .1, 0, 0, 0, 0, 0, .8, .1, .4, .4, 0, .1, .2, .4, 0, 0, 0, 0, 0, .1, .2, .2, .4, 0, 0, .2, 0, 0, 0, .1, .1],
  'schema':         [.1, .2, 0, 0, 0, .2, .3, .2, .5, .2, .2, 0, .1, .6, .2, .2, .4, .3, 0, 0, .2, .3, .2, .5, 0, 0, .5, .2, 0, .2, .3, .3],
  'regex':          [.2, .2, 0, 0, 0, 0, .2, .2, .2, .3, .1, 0, .2, .5, .3, .2, 0, 0, 0, 0, 0, .3, .3, .4, 0, 0, 0, 0, .2, .8, .1, .3],
  'pattern':        [.3, .3, 0, 0, 0, 0, 0, .1, .3, .3, 0, .2, .1, .4, .2, .3, .4, .3, 0, 0, .1, .3, .2, .5, 0, 0, .3, .2, .2, .3, .5, .3],

  // ─── Design Patterns ───
  'singleton':      [0, 0, 0, 0, 0, 0, 0, 0, .3, .2, 0, 0, 0, 0, .3, 0, .3, .4, 0, 0, .8, 0, .3, .5, 0, .2, .2, 0, 0, 0, .9, .2],
  'factory':        [.1, .2, 0, 0, 0, 0, 0, 0, .3, .2, 0, 0, .1, .3, .3, .3, .3, .7, 0, 0, .3, .2, .2, .5, 0, .1, .3, 0, 0, 0, .9, .2],
  'observer':       [.1, .3, .3, 0, 0, 0, 0, 0, .3, .3, 0, 0, .1, .3, .3, .4, .3, 0, 0, 0, .5, .2, .2, .5, 0, 0, .2, .3, 0, 0, .9, .3],
  'decorator':      [.1, .5, 0, 0, 0, 0, 0, 0, .2, .2, 0, 0, 0, .4, .2, .7, .3, .3, 0, 0, .2, .3, .2, .5, 0, 0, .3, 0, 0, 0, .9, .2],
  'adapter':        [.1, .2, 0, 0, 0, 0, 0, 0, .2, .2, 0, 0, .1, .3, .3, .4, .4, .2, 0, 0, .2, .2, .2, .5, 0, 0, .3, 0, 0, 0, .9, .2],
  'strategy':       [.2, .3, 0, 0, 0, 0, 0, 0, .2, .4, 0, 0, .1, .4, .3, .5, .2, .3, 0, 0, .3, .3, .2, .5, 0, 0, .3, 0, 0, 0, .9, .3],
  'proxy':          [.1, .2, 0, 0, .2, 0, .3, 0, .2, .3, 0, 0, .1, .3, .3, .3, .3, .3, 0, 0, .3, .2, .3, .5, 0, 0, .2, 0, 0, 0, .8, .3],
  'middleware':     [.1, .3, 0, 0, .3, 0, .2, 0, .2, .4, .2, 0, .2, .3, .3, .6, .2, .2, 0, 0, .3, .2, .2, .5, .2, 0, .2, 0, 0, 0, .7, .3],
  'event':          [.1, .2, .4, 0, 0, 0, 0, 0, .3, .4, 0, 0, .2, .3, .3, .3, 0, .3, 0, 0, .5, .2, .2, .5, 0, 0, .2, .2, 0, 0, .6, .2],
  'emitter':        [.1, .2, .4, 0, 0, 0, 0, 0, .3, .3, 0, 0, .2, .3, .3, .3, 0, .3, 0, 0, .5, .2, .2, .5, 0, 0, .2, .2, 0, 0, .6, .2],
  'iterator':       [.3, .4, 0, 0, 0, 0, 0, 0, .4, .4, 0, .2, .6, .4, .3, .3, 0, .2, 0, 0, .4, .3, .2, .4, 0, 0, .3, .5, 0, 0, .5, .3],
  'builder':        [.1, .2, 0, 0, 0, 0, 0, 0, .3, .2, 0, 0, .2, .3, .3, .3, .3, .6, 0, .3, .3, .2, .2, .5, 0, 0, .3, 0, 0, 0, .8, .2],

  // ─── String Processing ───
  'string':         [.1, .2, 0, 0, 0, 0, 0, 0, .4, .1, 0, 0, .2, .2, .3, 0, 0, 0, 0, .3, 0, .2, .2, .4, 0, .2, .2, 0, 0, .8, 0, .2],
  'replace':        [.1, .2, 0, 0, 0, 0, 0, 0, .3, .2, 0, 0, .3, .2, .4, 0, 0, 0, .3, 0, .2, .2, .2, .4, 0, 0, 0, 0, 0, .7, 0, .2],
  'match':          [.2, .2, 0, 0, 0, 0, 0, 0, .3, .3, 0, 0, .2, .3, .3, 0, 0, 0, 0, 0, 0, .3, .2, .4, 0, 0, 0, 0, 0, .7, 0, .3],
  'split':          [.1, .3, 0, 0, 0, 0, 0, 0, .4, .2, 0, 0, .2, .3, .3, 0, 0, 0, .3, 0, 0, .3, .2, .4, 0, 0, 0, .4, 0, .7, 0, .2],
  'join':           [.1, .3, 0, 0, 0, 0, 0, 0, .4, .2, 0, 0, .2, .3, .3, 0, 0, .3, 0, 0, 0, .3, .2, .4, 0, 0, 0, .4, 0, .7, 0, .2],
  'trim':           [0, .1, 0, 0, 0, 0, .1, 0, .2, .1, 0, 0, .1, .2, .3, 0, 0, 0, .2, 0, 0, .2, .2, .4, 0, 0, 0, 0, 0, .6, 0, .1],
  'template':       [.1, .2, 0, 0, 0, 0, 0, 0, .3, .2, 0, 0, .1, .4, .3, .3, .2, .5, 0, 0, .2, .2, .2, .5, 0, 0, .2, 0, 0, .6, .3, .2],
  'interpolate':    [.1, .2, 0, 0, 0, 0, 0, 0, .3, .2, 0, 0, .1, .3, .3, .2, 0, .4, 0, 0, .2, .2, .2, .5, 0, 0, .1, 0, 0, .6, .2, .2],
  'encode':         [.1, .1, 0, 0, .2, 0, .3, 0, .3, .2, 0, 0, .2, 0, .3, 0, 0, .3, 0, 0, .1, .2, .3, .4, .1, 0, 0, 0, 0, .5, 0, .2],
  'decode':         [.1, .1, 0, 0, .2, 0, .2, 0, .3, .2, .1, 0, .2, 0, .3, 0, 0, 0, .3, 0, .1, .2, .3, .4, .1, 0, 0, 0, 0, .5, 0, .2],

  // ─── Network / IO ───
  'http':           [0, .1, .2, 0, .9, 0, .2, 0, .3, .2, .3, 0, .2, .2, .3, 0, 0, 0, 0, 0, .3, 0, .2, .5, .8, 0, 0, 0, 0, 0, .1, .2],
  'fetch':          [0, .2, .3, 0, .8, 0, .2, 0, .3, .2, .3, 0, .2, .3, .3, .2, 0, 0, 0, 0, .3, .1, .2, .6, .8, 0, 0, 0, 0, 0, .1, .2],
  'request':        [0, .1, .2, 0, .8, 0, .2, 0, .3, .2, .3, 0, .2, .2, .3, 0, 0, .2, 0, 0, .3, 0, .2, .5, .8, 0, 0, 0, 0, 0, .1, .2],
  'response':       [0, .1, .2, 0, .8, 0, .2, 0, .3, .2, .2, 0, .2, .2, .3, 0, 0, .2, 0, 0, .3, 0, .2, .5, .7, 0, 0, 0, 0, 0, .1, .2],
  'socket':         [0, .1, .3, 0, .9, 0, .2, 0, .2, .3, .3, 0, .2, 0, .4, 0, 0, 0, 0, 0, .5, 0, .4, .4, .8, 0, 0, 0, 0, 0, .1, .2],
  'stream':         [.1, .3, .3, .2, .3, 0, 0, 0, .4, .3, .2, 0, .4, .3, .3, .3, 0, .2, .2, 0, .4, .2, .3, .4, .6, .2, 0, .3, 0, 0, .2, .3],
  'websocket':      [0, .1, .4, .2, .9, 0, .2, 0, .2, .3, .3, 0, .3, .2, .4, 0, 0, 0, 0, 0, .6, 0, .3, .5, .8, 0, 0, 0, 0, 0, .1, .2],
  'api':            [.1, .1, 0, 0, .7, 0, .3, 0, .3, .2, .3, 0, .2, .3, .3, .2, .3, .2, 0, 0, .3, .1, .2, .6, .5, 0, .2, 0, 0, 0, .3, .2],
  'rest':           [.1, .1, 0, 0, .7, 0, .3, 0, .3, .2, .3, 0, .2, .4, .3, .2, .3, .2, 0, 0, .2, .1, .2, .6, .5, 0, .2, 0, 0, 0, .3, .2],

  // ─── Persistence ───
  'database':       [0, 0, .2, 0, .2, .9, .3, 0, .7, .2, .3, 0, .2, .3, .3, 0, .4, .2, .3, 0, .7, 0, .3, .4, .5, .3, .2, .4, 0, 0, .2, .4],
  'query':          [.2, .2, 0, 0, .2, .7, 0, 0, .5, .3, .2, 0, .2, .4, .3, .2, 0, 0, 0, 0, .3, .2, .2, .5, .4, 0, 0, .4, 0, 0, .1, .4],
  'sql':            [.2, .1, 0, 0, .2, .8, 0, 0, .6, .2, .2, 0, .2, .5, .3, .2, .3, .2, .3, 0, .4, .1, .3, .4, .4, 0, .2, .4, 0, 0, .1, .4],
  'write':          [0, 0, 0, 0, 0, .7, 0, 0, .3, .2, .2, 0, .2, 0, .5, 0, 0, .3, 0, 0, .4, 0, .3, .3, .6, .1, 0, 0, 0, 0, 0, .2],
  'read':           [0, .1, 0, 0, 0, .6, 0, 0, .3, .2, .2, 0, .2, .2, .4, 0, 0, 0, 0, 0, .2, .2, .3, .3, .6, .1, 0, 0, 0, 0, 0, .2],
  'file':           [0, 0, 0, 0, 0, .7, 0, 0, .3, .2, .2, 0, .2, 0, .4, 0, .2, .2, .2, 0, .3, 0, .3, .3, .7, .1, 0, 0, 0, 0, 0, .2],
  'storage':        [0, 0, 0, 0, 0, .8, 0, 0, .5, .1, .1, 0, .1, .2, .3, 0, .3, .2, 0, 0, .5, 0, .3, .4, .4, .4, 0, .3, 0, 0, .1, .3],

  // ─── Security ───
  'encrypt':        [0, .1, 0, 0, 0, 0, .9, 0, .2, .2, .2, 0, .2, 0, .3, 0, 0, .3, 0, 0, .2, .1, .4, .3, 0, .2, 0, 0, .4, 0, .1, .3],
  'decrypt':        [0, .1, 0, 0, 0, 0, .9, 0, .2, .2, .2, 0, .2, 0, .3, 0, 0, 0, .3, 0, .2, .1, .4, .3, 0, .2, 0, 0, .4, 0, .1, .3],
  'authenticate':   [0, .1, 0, 0, .3, 0, .9, 0, .2, .3, .3, 0, .1, 0, .4, 0, 0, .2, 0, 0, .4, .1, .3, .4, .3, 0, .2, 0, 0, 0, .2, .2],
  'authorize':      [0, .1, 0, 0, .3, 0, .9, 0, .2, .4, .3, 0, .1, .2, .4, 0, 0, .2, 0, 0, .4, .1, .3, .4, .2, 0, .2, 0, 0, 0, .2, .2],
  'token':          [0, .1, 0, .2, .3, 0, .7, 0, .3, .2, .2, 0, .1, .2, .3, 0, 0, .3, .2, 0, .3, .1, .3, .4, .2, 0, .2, 0, 0, .2, .2, .2],
  'jwt':            [0, .1, 0, .2, .4, 0, .8, 0, .3, .2, .2, 0, .1, .2, .3, 0, 0, .3, .2, 0, .3, .1, .3, .4, .2, 0, .2, 0, 0, .2, .2, .2],

  // ─── Testing ───
  'test':           [0, .1, 0, 0, 0, 0, 0, .9, .1, .3, .2, 0, .2, .2, .3, 0, 0, .2, 0, 0, .2, .2, .2, .5, 0, 0, .2, 0, 0, 0, .1, .2],
  'spec':           [0, .1, 0, 0, 0, 0, 0, .8, .1, .2, .1, 0, .1, .4, .2, 0, 0, .2, 0, 0, .1, .3, .2, .5, 0, 0, .2, 0, 0, 0, .1, .1],
  'mock':           [0, .2, 0, 0, 0, 0, 0, .8, .2, .2, .1, 0, .1, .3, .3, .2, 0, .3, 0, 0, .3, .2, .2, .5, 0, 0, .2, 0, 0, 0, .2, .1],
  'stub':           [0, .2, 0, 0, 0, 0, 0, .7, .2, .2, .1, 0, .1, .3, .3, .2, 0, .3, 0, 0, .3, .1, .2, .5, 0, 0, .1, 0, 0, 0, .2, .1],
  'fixture':        [0, .1, 0, 0, 0, .2, 0, .7, .3, .1, .1, 0, .1, .3, .2, 0, .2, .3, 0, 0, .3, .1, .2, .5, 0, .1, .1, .2, 0, 0, .1, .1],
  'benchmark':      [0, .1, 0, .3, 0, 0, 0, .5, .2, .2, 0, 0, .3, .2, .3, 0, 0, .2, 0, 0, .2, .1, .3, .4, 0, .2, 0, 0, .2, 0, .1, .8],
  'coverage':       [0, .1, 0, 0, 0, 0, 0, .8, .2, .2, 0, 0, .2, .3, .2, 0, 0, .2, 0, 0, .2, .1, .2, .5, 0, 0, .1, 0, .1, 0, .1, .3],

  // ─── Type System ───
  'generic':        [.1, .3, 0, 0, 0, 0, 0, 0, .2, .1, 0, 0, 0, .4, .2, .4, .2, .4, 0, 0, 0, .3, .2, .5, 0, 0, .9, .3, 0, 0, .3, .2],
  'interface':      [.1, .2, 0, 0, 0, 0, 0, 0, .2, .1, 0, 0, 0, .5, .2, .3, .5, .2, 0, 0, 0, .3, .2, .5, 0, 0, .8, 0, 0, 0, .5, .2],
  'type':           [.1, .2, 0, 0, 0, 0, 0, .2, .2, .1, .2, 0, 0, .5, .2, .2, .3, .2, 0, .2, 0, .3, .2, .4, 0, 0, .9, .2, 0, 0, .3, .2],
  'enum':           [.1, .1, 0, 0, 0, 0, 0, 0, .3, .2, 0, 0, 0, .4, .2, 0, .4, .2, 0, .4, .1, .2, .3, .4, 0, 0, .7, .2, 0, 0, .3, .2],
  'struct':         [.1, .1, 0, 0, 0, 0, 0, 0, .5, .1, 0, 0, 0, .3, .3, 0, .6, .3, 0, .3, .2, .2, .4, .4, 0, .3, .6, .2, 0, 0, .2, .2],
  'trait':          [.1, .3, 0, 0, 0, 0, 0, 0, .2, .1, 0, 0, 0, .5, .2, .4, .4, .2, 0, 0, 0, .3, .2, .4, 0, 0, .8, 0, 0, 0, .4, .2],

  // ─── Mathematical ───
  'fibonacci':      [.7, .3, 0, 0, 0, 0, 0, 0, .3, .2, 0, .8, .3, 0, .4, 0, 0, .3, 0, 0, 0, .5, .2, .3, 0, .2, 0, .2, .8, 0, 0, .3],
  'factorial':      [.6, .3, 0, 0, 0, 0, 0, 0, .2, .2, 0, .8, .2, 0, .4, 0, 0, .3, 0, 0, 0, .5, .2, .3, 0, .1, 0, .1, .8, 0, 0, .3],
  'gcd':            [.5, .2, 0, 0, 0, 0, 0, 0, .2, .2, 0, .6, .3, 0, .4, 0, 0, .2, 0, 0, 0, .4, .3, .2, 0, .1, 0, .1, .9, 0, 0, .3],
  'prime':          [.5, .2, 0, 0, 0, 0, 0, 0, .3, .3, 0, .3, .5, 0, .4, 0, 0, .2, 0, 0, 0, .4, .3, .2, 0, .1, 0, .2, .9, 0, 0, .4],
  'matrix':         [.4, .2, .2, 0, 0, 0, 0, 0, .7, .2, 0, .2, .4, 0, .3, 0, .4, .2, 0, 0, .2, .3, .4, .3, 0, .3, 0, .5, .8, 0, 0, .5],
  'permutation':    [.6, .3, 0, 0, 0, 0, 0, 0, .4, .3, 0, .7, .3, 0, .4, 0, 0, .4, 0, 0, 0, .4, .3, .3, 0, .2, 0, .4, .7, 0, 0, .4],
  'combination':    [.6, .3, 0, 0, 0, 0, 0, 0, .4, .3, 0, .6, .3, 0, .4, 0, 0, .4, 0, 0, 0, .4, .3, .3, 0, .2, 0, .4, .7, 0, 0, .4],

  // ─── Natural language intent terms ───
  'prevent':        [0, .1, 0, .3, 0, 0, .3, 0, 0, .4, .3, 0, .1, 0, .4, 0, 0, 0, 0, 0, .3, .1, .2, .3, 0, 0, 0, 0, 0, 0, .2, .3],
  'often':          [0, 0, 0, .5, 0, 0, 0, 0, 0, .2, 0, 0, .3, 0, .2, 0, 0, 0, 0, 0, .2, 0, 0, .3, 0, 0, 0, 0, 0, 0, 0, .2],
  'fast':           [.2, 0, 0, .3, 0, 0, 0, 0, 0, .2, 0, 0, .2, 0, .3, 0, 0, 0, 0, 0, 0, 0, .3, .2, 0, .2, 0, 0, 0, 0, 0, .9],
  'efficient':      [.3, .1, 0, 0, 0, 0, 0, 0, .2, .2, 0, 0, .2, 0, .3, 0, 0, 0, 0, 0, 0, .1, .3, .3, 0, .3, 0, 0, .2, 0, 0, .9],
  'optimize':       [.3, .1, 0, 0, 0, 0, 0, 0, .2, .3, 0, 0, .3, 0, .4, 0, 0, 0, 0, 0, .2, .1, .3, .3, 0, .3, 0, 0, .2, 0, 0, 1],
  'performance':    [.2, .1, 0, .2, 0, 0, 0, .2, .2, .2, 0, 0, .2, 0, .3, 0, 0, 0, 0, 0, .1, .1, .3, .3, 0, .3, 0, 0, .1, 0, 0, .9],
  'memory':         [.1, 0, 0, 0, 0, .3, 0, 0, .3, .1, 0, 0, .1, 0, .3, 0, .2, 0, .2, 0, .3, 0, .6, .2, 0, .9, 0, .2, .1, 0, .1, .5],
  'safe':           [0, .2, .1, 0, 0, 0, .6, .2, .1, .2, .3, 0, 0, .3, .2, 0, 0, 0, 0, .3, .1, .3, .2, .4, 0, 0, .3, 0, 0, 0, .2, .2],
  'robust':         [.1, .2, 0, 0, 0, 0, .3, .2, .2, .3, .5, 0, .1, .2, .3, .2, 0, 0, 0, 0, .3, .2, .2, .4, 0, 0, .2, 0, 0, 0, .3, .4],
  'resilient':      [.1, .2, .2, 0, .2, 0, .2, 0, .1, .3, .6, 0, .2, 0, .4, .2, 0, 0, 0, 0, .4, .1, .2, .4, .2, 0, 0, 0, 0, 0, .2, .4],
  'scalable':       [.2, .1, .3, 0, .2, .2, 0, 0, .3, .2, 0, 0, .2, .2, .3, .2, .2, 0, 0, 0, .3, .1, .3, .4, .2, .2, 0, .2, 0, 0, .3, .7],
  'reusable':       [.1, .3, 0, 0, 0, 0, 0, 0, .2, .1, 0, 0, 0, .3, .2, .5, .2, .3, 0, 0, 0, .3, .1, .5, 0, 0, .3, 0, 0, 0, .5, .3],

  // ─── Expanded intent vocabulary (The Missing Eye) ───
  // These map natural-language descriptions to the same semantic space as code terms
  'rapid':          [0, 0, 0, .7, 0, 0, 0, 0, 0, .3, 0, 0, .3, 0, .3, 0, 0, 0, 0, 0, .2, 0, .1, .3, 0, 0, 0, 0, 0, 0, 0, .5],
  'repeated':       [0, 0, 0, .6, 0, 0, 0, 0, 0, .4, 0, 0, .5, 0, .3, 0, 0, 0, 0, 0, .3, 0, .1, .3, 0, 0, 0, 0, 0, 0, 0, .3],
  'calling':        [.1, .3, 0, .3, 0, 0, 0, 0, 0, .4, 0, 0, .3, 0, .4, .2, 0, 0, 0, 0, .2, .1, .2, .4, 0, 0, 0, 0, 0, 0, .1, .3],
  'repeatedly':     [0, 0, 0, .7, 0, 0, 0, 0, 0, .4, 0, 0, .6, 0, .3, 0, 0, 0, 0, 0, .3, 0, .1, .3, 0, 0, 0, 0, 0, 0, 0, .3],
  'calls':          [.1, .3, 0, .3, 0, 0, 0, 0, 0, .4, 0, 0, .3, 0, .4, .2, 0, 0, 0, 0, .2, .1, .2, .4, 0, 0, 0, 0, 0, 0, .1, .3],
  'frequency':      [0, 0, 0, .8, 0, 0, 0, 0, 0, .3, 0, 0, .4, 0, .3, 0, 0, 0, 0, 0, .3, 0, .1, .4, 0, 0, 0, 0, .2, 0, .1, .4],
  'spam':           [0, 0, 0, .6, .2, 0, .3, 0, 0, .4, .2, 0, .4, 0, .4, 0, 0, 0, .2, 0, .3, 0, .1, .3, .2, 0, 0, 0, 0, 0, .1, .3],
  'flood':          [0, 0, .2, .6, .2, 0, .3, 0, 0, .4, .2, 0, .4, 0, .4, 0, 0, 0, .2, 0, .3, 0, .1, .3, .2, 0, 0, 0, 0, 0, .1, .3],
  'limit':          [0, .1, 0, .5, .1, 0, .2, 0, .2, .4, .2, 0, .2, 0, .4, 0, 0, 0, 0, 0, .3, .1, .2, .4, 0, 0, 0, 0, 0, 0, .2, .4],
  'wait':           [0, .1, 0, .7, 0, 0, 0, 0, 0, .4, 0, 0, .2, 0, .4, 0, 0, 0, 0, 0, .4, 0, .1, .3, .1, 0, 0, 0, 0, 0, .1, .2],
  'store':          [0, 0, 0, 0, 0, .7, 0, 0, .5, .1, 0, 0, .1, .2, .3, 0, .3, .2, 0, 0, .5, 0, .3, .4, .3, .4, 0, .3, 0, 0, .1, .3],
  'save':           [0, 0, 0, 0, 0, .7, 0, 0, .4, .1, 0, 0, .1, 0, .4, 0, .2, .2, 0, 0, .4, 0, .3, .3, .3, .3, 0, .2, 0, 0, .1, .2],
  'already':        [0, 0, 0, .3, 0, .3, 0, 0, .3, .2, 0, 0, .1, 0, .3, 0, 0, 0, 0, 0, .3, .1, .1, .3, 0, .2, 0, .2, 0, 0, .1, .3],
  'computed':       [.3, .2, 0, 0, 0, .2, 0, 0, .4, .2, 0, 0, .2, 0, .3, 0, 0, 0, 0, 0, .2, .2, .2, .3, 0, .3, 0, .3, .3, 0, .1, .5],
  'unique':         [.2, .2, 0, 0, 0, 0, 0, 0, .5, .2, 0, 0, .3, .2, .3, 0, .2, 0, 0, .2, 0, .3, .2, .3, 0, .1, 0, .5, .1, 0, .1, .3],
  'duplicate':      [.1, .1, 0, 0, 0, 0, 0, 0, .4, .2, 0, 0, .3, 0, .3, 0, .2, 0, .3, 0, .1, .1, .2, .3, 0, .2, 0, .5, .1, 0, .1, .3],
  'remove':         [.1, .1, 0, 0, 0, 0, 0, 0, .3, .2, 0, 0, .3, 0, .4, 0, 0, 0, .5, 0, .2, .1, .2, .3, 0, .1, 0, .4, 0, 0, .1, .2],
  'add':            [.1, .1, 0, 0, 0, 0, 0, 0, .3, .2, 0, 0, .3, 0, .4, 0, 0, .4, 0, 0, .2, .1, .2, .3, 0, .1, 0, .4, 0, 0, .1, .2],
  'create':         [.1, .2, 0, 0, 0, 0, 0, 0, .3, .2, 0, 0, .2, .2, .3, 0, .2, .5, 0, 0, .2, .2, .2, .4, 0, 0, .2, .2, 0, 0, .2, .3],
  'delete':         [.1, .1, 0, 0, 0, .2, 0, 0, .3, .2, .1, 0, .2, 0, .4, 0, 0, 0, .6, 0, .2, .1, .2, .3, 0, .1, 0, .3, 0, 0, .1, .2],
  'update':         [.1, .1, 0, 0, 0, .3, 0, 0, .3, .2, 0, 0, .2, 0, .4, 0, 0, .3, .2, 0, .3, .1, .2, .3, 0, .2, 0, .3, 0, 0, .1, .2],
  'wrap':           [.1, .4, 0, 0, 0, 0, 0, 0, .2, .2, .2, 0, 0, .3, .2, .5, .2, .3, 0, 0, .2, .3, .2, .5, 0, 0, .2, 0, 0, 0, .4, .2],
  'batch':          [.2, .1, .3, 0, 0, .2, 0, 0, .5, .2, 0, 0, .4, .2, .4, 0, .2, .2, 0, 0, .3, .1, .2, .4, .2, .2, 0, .5, 0, 0, .2, .6],
  'chunk':          [.2, .2, 0, 0, 0, 0, 0, 0, .5, .2, 0, 0, .4, .2, .3, 0, .2, .2, 0, 0, .1, .2, .2, .4, 0, .2, 0, .6, 0, 0, .1, .4],
  'paginate':       [.1, .1, 0, 0, .2, .2, 0, 0, .5, .2, 0, 0, .4, .2, .3, 0, .2, .2, 0, 0, .3, .1, .2, .4, .3, .2, 0, .5, 0, 0, .2, .4],
  'normalize':      [.2, .2, 0, 0, 0, 0, 0, 0, .5, .2, 0, 0, .3, .2, .3, 0, 0, .3, 0, 0, .1, .3, .2, .4, 0, 0, 0, .4, .2, .3, .1, .3],
  'deduplicate':    [.2, .2, 0, 0, 0, 0, 0, 0, .5, .2, 0, 0, .3, .2, .3, 0, .2, 0, .3, .2, 0, .3, .2, .4, 0, .1, 0, .5, .1, 0, .1, .4],
  'schedule':       [.1, .1, .3, .7, 0, 0, 0, 0, .2, .4, 0, 0, .3, 0, .4, 0, 0, .2, 0, 0, .5, 0, .2, .4, 0, 0, 0, 0, 0, 0, .2, .3],
  'queue-up':       [.2, .1, .4, .4, 0, 0, 0, 0, .5, .3, 0, 0, .3, 0, .4, 0, .4, .2, 0, 0, .5, .1, .3, .4, .1, .2, 0, .4, 0, 0, .2, .4],
  'paginate':       [.1, .1, 0, 0, .2, .2, 0, 0, .5, .2, 0, 0, .4, .2, .3, 0, .2, .2, 0, 0, .3, .1, .2, .4, .3, .2, 0, .5, 0, 0, .2, .4],
};

// ─── Core Functions ───

/**
 * Get the vector for a term. Case-insensitive, handles hyphens.
 * Returns null for unknown terms.
 */
function getVector(term) {
  const normalized = term.toLowerCase().replace(/\s+/g, '-');
  if (VOCABULARY[normalized]) return VOCABULARY[normalized];

  // Try without hyphens
  const noHyphen = normalized.replace(/-/g, '');
  for (const [key, vec] of Object.entries(VOCABULARY)) {
    if (key.replace(/-/g, '') === noHyphen) return vec;
  }

  // Basic stemming: try removing common suffixes
  const stems = [normalized.replace(/ing$/, ''), normalized.replace(/tion$/, 't'), normalized.replace(/s$/, '')];
  for (const stem of stems) {
    if (VOCABULARY[stem]) return VOCABULARY[stem];
  }

  return null;
}

/**
 * Embed a document (text) into a 32-dimensional vector.
 * Averages known word vectors, handles bigrams.
 */
function embedDocument(text) {
  const words = text.toLowerCase().replace(/[^a-z0-9\s-]/g, ' ').split(/\s+/).filter(w => w.length > 1);
  const vec = new Float64Array(32);
  let count = 0;

  // Single words
  for (const word of words) {
    const v = getVector(word);
    if (v) {
      for (let i = 0; i < 32; i++) vec[i] += v[i];
      count++;
    }
  }

  // Bigrams (e.g., "binary search" → "binary-search")
  for (let i = 0; i < words.length - 1; i++) {
    const bigram = words[i] + '-' + words[i + 1];
    const v = getVector(bigram);
    if (v) {
      for (let j = 0; j < 32; j++) vec[j] += v[j] * 1.5; // Bigrams weighted higher
      count += 1.5;
    }
  }

  // Normalize to unit vector
  if (count === 0) return Array.from(vec);
  for (let i = 0; i < 32; i++) vec[i] /= count;

  let mag = 0;
  for (let i = 0; i < 32; i++) mag += vec[i] * vec[i];
  mag = Math.sqrt(mag);
  if (mag > 0) {
    for (let i = 0; i < 32; i++) vec[i] /= mag;
  }

  return Array.from(vec);
}

/**
 * Cosine similarity between two document embeddings.
 */
function vectorSimilarity(textA, textB) {
  const vecA = embedDocument(textA);
  const vecB = embedDocument(textB);

  let dot = 0, magA = 0, magB = 0;
  for (let i = 0; i < 32; i++) {
    dot += vecA[i] * vecB[i];
    magA += vecA[i] * vecA[i];
    magB += vecB[i] * vecB[i];
  }

  const denom = Math.sqrt(magA) * Math.sqrt(magB);
  return denom > 0 ? dot / denom : 0;
}

/**
 * Find the nearest terms in the vocabulary to a query.
 */
function nearestTerms(query, topK = 10) {
  const queryVec = embedDocument(query);

  // Check for zero vector
  let qMag = 0;
  for (let i = 0; i < 32; i++) qMag += queryVec[i] * queryVec[i];
  if (qMag === 0) return [];

  const scored = Object.entries(VOCABULARY).map(([term, vec]) => {
    let dot = 0, vMag = 0;
    for (let i = 0; i < 32; i++) {
      dot += queryVec[i] * vec[i];
      vMag += vec[i] * vec[i];
    }
    const denom = Math.sqrt(qMag) * Math.sqrt(vMag);
    const similarity = denom > 0 ? dot / denom : 0;
    return { term, similarity };
  });

  return scored
    .sort((a, b) => b.similarity - a.similarity)
    .slice(0, topK);
}

module.exports = {
  getVector,
  embedDocument,
  vectorSimilarity,
  nearestTerms,
  VOCABULARY,
  DIMENSIONS,
};
